"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const React = __importStar(require("react"));
const react_table_1 = __importDefault(require("react-table"));
const Logger_1 = require("../../../../web/js/logger/Logger");
const TagInput_1 = require("../TagInput");
const Optional_1 = require("../../../../web/js/util/ts/Optional");
const Preconditions_1 = require("../../../../web/js/Preconditions");
const Tags_1 = require("../../../../web/js/tags/Tags");
const DateTimeTableCell_1 = require("../DateTimeTableCell");
const RendererAnalytics_1 = require("../../../../web/js/ga/RendererAnalytics");
const MessageBanner_1 = require("../MessageBanner");
const DocDropdown_1 = require("../DocDropdown");
const DocRepoTableDropdown_1 = require("./DocRepoTableDropdown");
const DocRepoTableColumns_1 = require("./DocRepoTableColumns");
const SettingsStore_1 = require("../../../../web/js/datastore/SettingsStore");
const SimpleReactor_1 = require("../../../../web/js/reactor/SimpleReactor");
const RepoDocMetaLoaders_1 = require("../RepoDocMetaLoaders");
const PersistenceLayerManagers_1 = require("../../../../web/js/datastore/PersistenceLayerManagers");
const SynchronizingDocLoader_1 = require("../util/SynchronizingDocLoader");
const ReleasingReactComponent_1 = __importDefault(require("../framework/ReleasingReactComponent"));
const Arrays_1 = require("../../../../web/js/util/Arrays");
const Numbers_1 = require("../../../../web/js/util/Numbers");
const SimpleTooltip_1 = require("../../../../web/js/ui/tooltip/SimpleTooltip");
const TagButton_1 = require("./TagButton");
const RepoHeader_1 = require("../repo_header/RepoHeader");
const electron_1 = require("electron");
const FixedNav_1 = require("../FixedNav");
const AddContentButton_1 = require("./AddContentButton");
const Functions_1 = require("../../../../web/js/util/Functions");
const DocButton_1 = require("./doc_buttons/DocButton");
const FlagDocButton_1 = require("./doc_buttons/FlagDocButton");
const ArchiveDocButton_1 = require("./doc_buttons/ArchiveDocButton");
const MultiDeleteButton_1 = require("./multi_buttons/MultiDeleteButton");
const DocRepoFilterBar_1 = require("./DocRepoFilterBar");
const FilteredRepoDocInfoIndex_1 = require("./FilteredRepoDocInfoIndex");
const AppRuntime_1 = require("../../../../web/js/AppRuntime");
const Toaster_1 = require("../../../../web/js/ui/toaster/Toaster");
const Input_1 = __importDefault(require("reactstrap/lib/Input"));
const log = Logger_1.Logger.create();
class DocRepoTable extends ReleasingReactComponent_1.default {
    constructor(props, context) {
        super(props, context);
        this.syncBarProgress = new SimpleReactor_1.SimpleReactor();
        this.persistenceLayerManager = this.props.persistenceLayerManager;
        this.synchronizingDocLoader = new SynchronizingDocLoader_1.SynchronizingDocLoader(this.props.persistenceLayerManager);
        this.onDocTagged = this.onDocTagged.bind(this);
        this.onDocDeleted = this.onDocDeleted.bind(this);
        this.onDocSetTitle = this.onDocSetTitle.bind(this);
        this.onSelectedColumns = this.onSelectedColumns.bind(this);
        this.onFilterByTitle = this.onFilterByTitle.bind(this);
        this.onToggleFilterArchived = this.onToggleFilterArchived.bind(this);
        this.onToggleFlaggedOnly = this.onToggleFlaggedOnly.bind(this);
        this.clearSelected = this.clearSelected.bind(this);
        this.onMultiTagged = this.onMultiTagged.bind(this);
        this.onMultiDeleted = this.onMultiDeleted.bind(this);
        this.getSelected = this.getSelected.bind(this);
        this.cmdImportFromDisk = this.cmdImportFromDisk.bind(this);
        this.cmdCaptureWebPage = this.cmdCaptureWebPage.bind(this);
        this.state = {
            data: [],
            columns: new DocRepoTableColumns_1.DocRepoTableColumns(),
            selected: []
        };
        const onRefreshed = repoDocInfos => this.doRefresh(repoDocInfos);
        const repoDocInfosProvider = () => Object.values(this.props.repoDocMetaManager.repoDocInfoIndex);
        this.filteredRepoDocInfoIndex =
            new FilteredRepoDocInfoIndex_1.FilteredRepoDocInfoIndex(onRefreshed, repoDocInfosProvider);
        this.init();
        this.initAsync()
            .catch(err => log.error("Could not init: ", err));
    }
    init() {
        PersistenceLayerManagers_1.PersistenceLayerManagers.onPersistenceManager(this.props.persistenceLayerManager, (persistenceLayer) => {
            this.releaser.register(persistenceLayer.addEventListener(() => this.refresh()));
        });
        this.releaser.register(RepoDocMetaLoaders_1.RepoDocMetaLoaders.addThrottlingEventListener(this.props.repoDocMetaLoader, () => this.refresh()));
        this.releaser.register(this.props.repoDocMetaLoader.addEventListener(event => {
            if (!DocRepoTable.hasSentInitAnalyitics && event.progress.progress === 100) {
                this.emitInitAnalytics(this.props.repoDocMetaManager.repoDocInfoIndex);
                DocRepoTable.hasSentInitAnalyitics = true;
            }
        }));
    }
    initAsync() {
        return __awaiter(this, void 0, void 0, function* () {
            const settingProvider = yield SettingsStore_1.SettingsStore.load();
            log.info("Settings loaded: ", settingProvider);
            Optional_1.Optional.of(settingProvider().documentRepository)
                .map(current => current.columns)
                .when(columns => {
                log.info("Loaded columns from settings: ", columns);
                this.setState(Object.assign({}, this.state, { columns }));
                this.refresh();
            });
            this.refresh();
        });
    }
    emitInitAnalytics(repoDocs) {
        const nrDocs = Object.keys(repoDocs).length;
        RendererAnalytics_1.RendererAnalytics.set({ 'nrDocs': nrDocs });
        const persistenceLayerType = this.persistenceLayerManager.currentType();
        RendererAnalytics_1.RendererAnalytics.event({ category: 'document-repository', action: `docs-loaded-${persistenceLayerType}-${nrDocs}` });
    }
    selectRow(selectedIdx, event, checkbox = false) {
        if (typeof selectedIdx === 'string') {
            selectedIdx = parseInt(selectedIdx);
        }
        let selected = [selectedIdx];
        if (event.getModifierState("Shift")) {
            let min = 0;
            let max = 0;
            if (this.state.selected.length > 0) {
                const sorted = [...this.state.selected].sort((a, b) => a - b);
                min = Arrays_1.Arrays.first(sorted);
                max = Arrays_1.Arrays.last(sorted);
            }
            selected = [...Numbers_1.Numbers.range(Math.min(min, selectedIdx), Math.max(max, selectedIdx))];
        }
        const selectIndividual = (event.getModifierState("Control") || event.getModifierState("Meta")) || checkbox;
        if (selectIndividual) {
            selected = [...this.state.selected];
            if (selected.includes(selectedIdx)) {
                selected.splice(selected.indexOf(selectedIdx), 1);
            }
            else {
                selected = [...selected, selectedIdx];
            }
        }
        this.setState(Object.assign({}, this.state, { selected }));
    }
    onMultiTagged(tags) {
        const repoDocInfos = this.getSelected();
        for (const repoDocInfo of repoDocInfos) {
            const existingTags = Object.values(repoDocInfo.tags || {});
            const effectTags = Tags_1.Tags.union(existingTags, tags || []);
            this.onDocTagged(repoDocInfo, effectTags)
                .catch(err => log.error(err));
        }
    }
    onMultiDeleted() {
        const repoDocInfos = this.getSelected();
        for (const repoDocInfo of repoDocInfos) {
            this.onDocDeleted(repoDocInfo);
        }
        this.clearSelected();
    }
    clearSelected() {
        setTimeout(() => {
            this.setState(Object.assign({}, this.state, { selected: [] }));
        }, 1);
    }
    getSelected() {
        const resolvedState = this.reactTable.getResolvedState();
        const sortedData = resolvedState.sortedData;
        const result = this.state.selected
            .map(selectedIdx => sortedData[selectedIdx])
            .filter(item => Preconditions_1.isPresent(item))
            .map(item => item._original);
        return result;
    }
    render() {
        const { data } = this.state;
        return (React.createElement(FixedNav_1.FixedNav, { id: "doc-repo-table" },
            React.createElement("header", null,
                React.createElement(RepoHeader_1.RepoHeader, { persistenceLayerManager: this.props.persistenceLayerManager }),
                React.createElement("div", { id: "header-filter" },
                    React.createElement("div", { style: { display: 'flex' } },
                        React.createElement("div", { className: "", style: { whiteSpace: 'nowrap', marginTop: 'auto', marginBottom: 'auto', display: 'flex' } },
                            React.createElement("div", { className: "mr-1", style: { whiteSpace: 'nowrap', marginTop: 'auto', marginBottom: 'auto' } },
                                React.createElement(AddContentButton_1.AddContentButton, { importFromDisk: () => this.cmdImportFromDisk(), captureWebPage: this.cmdCaptureWebPage })),
                            React.createElement("div", { className: "mr-1", style: { whiteSpace: 'nowrap', marginTop: 'auto', marginBottom: 'auto' } },
                                React.createElement("div", { style: { display: this.state.selected.length <= 1 ? 'none' : 'flex' } },
                                    React.createElement("div", null,
                                        React.createElement(TagButton_1.TagButton, { id: "tag-multiple-documents", tagsDBProvider: () => this.props.repoDocMetaManager.tagsDB, onSelectedTags: tags => this.onMultiTagged(tags) }),
                                        React.createElement(SimpleTooltip_1.SimpleTooltip, { target: "tag-multiple-documents", placement: "bottom" }, "Tag multiple documents at once.  To find untagged documents sort by the 'Tags' column (twice).  Once to sort alphabetically and then second click will reverse the sort showing untagged documents.")),
                                    React.createElement("div", { className: "ml-1" },
                                        React.createElement(MultiDeleteButton_1.MultiDeleteButton, { onCancel: Functions_1.NULL_FUNCTION, onConfirm: () => this.onMultiDeleted() }))))),
                        React.createElement("div", { style: { marginLeft: 'auto' } },
                            React.createElement(DocRepoFilterBar_1.DocRepoFilterBar, { onToggleFlaggedOnly: value => this.onToggleFlaggedOnly(value), onToggleFilterArchived: value => this.onToggleFilterArchived(value), onFilterByTitle: (title) => this.onFilterByTitle(title), tagsDBProvider: () => this.props.repoDocMetaManager.tagsDB, refresher: () => this.refresh(), filteredTags: this.filteredRepoDocInfoIndex.filters.filteredTags, right: React.createElement("div", { className: "", style: { whiteSpace: 'nowrap', marginTop: 'auto', marginBottom: 'auto' } },
                                    React.createElement(DocRepoTableDropdown_1.DocRepoTableDropdown, { id: "table-dropdown", options: Object.values(this.state.columns), onSelectedColumns: (selectedColumns) => this.onSelectedColumns(selectedColumns) })) })))),
                React.createElement(MessageBanner_1.MessageBanner, null)),
            React.createElement(FixedNav_1.FixedNavBody, null,
                React.createElement("div", { id: "doc-table", style: { height: '100%' } },
                    React.createElement(react_table_1.default, { data: data, ref: (r) => this.reactTable = r, columns: [
                            {
                                id: 'doc-checkbox',
                                Header: (col) => {
                                    const checked = this.state.selected.length === col.data.length && col.data.length > 0;
                                    return (React.createElement("div", null,
                                        React.createElement(Input_1.default, { checked: checked, style: {
                                                marginLeft: 'auto',
                                                marginRight: 'auto',
                                                margin: 'auto',
                                                position: 'relative',
                                                top: '2px',
                                                width: '16px',
                                                height: '16px',
                                            }, className: "m-auto", onChange: Functions_1.NULL_FUNCTION, onClick: () => {
                                                const computeSelected = () => {
                                                    if (this.state.selected.length !== col.data.length) {
                                                        return Numbers_1.Numbers.range(0, col.data.length - 1);
                                                    }
                                                    else {
                                                        return [];
                                                    }
                                                };
                                                const selected = computeSelected();
                                                this.setState(Object.assign({}, this.state, { selected }));
                                            }, type: "checkbox" })));
                                },
                                accessor: '',
                                maxWidth: 25,
                                defaultSortDesc: true,
                                resizable: false,
                                sortable: false,
                                className: 'doc-checkbox',
                                Cell: (row) => {
                                    const viewIndex = row.viewIndex;
                                    return (React.createElement("div", { style: { lineHeight: '1em' } },
                                        React.createElement(Input_1.default, { checked: this.state.selected.includes(viewIndex), style: {
                                                marginLeft: 'auto',
                                                marginRight: 'auto',
                                                margin: 'auto',
                                                position: 'relative',
                                                top: '2px',
                                                width: '16px',
                                                height: '16px',
                                            }, className: "m-auto", onChange: Functions_1.NULL_FUNCTION, onClick: (event) => this.selectRow(viewIndex, event.nativeEvent, true), type: "checkbox" })));
                                }
                            },
                            {
                                Header: 'Title',
                                accessor: 'title',
                                className: 'doc-table-col-title',
                                Cell: (row) => {
                                    const id = 'doc-repo-row-title' + row.index;
                                    return (React.createElement("div", { id: id },
                                        React.createElement("div", null, row.value)));
                                }
                            },
                            {
                                Header: 'Updated',
                                accessor: 'lastUpdated',
                                show: this.state.columns.lastUpdated.selected,
                                maxWidth: 85,
                                defaultSortDesc: true,
                                className: 'doc-table-col-updated',
                                Cell: (row) => (React.createElement(DateTimeTableCell_1.DateTimeTableCell, { className: "doc-col-last-updated", datetime: row.value }))
                            },
                            {
                                Header: 'Added',
                                accessor: 'added',
                                show: this.state.columns.added.selected,
                                maxWidth: 85,
                                defaultSortDesc: true,
                                className: 'doc-table-col-added',
                                Cell: (row) => (React.createElement(DateTimeTableCell_1.DateTimeTableCell, { className: "doc-col-added", datetime: row.value }))
                            },
                            {
                                Header: 'Site',
                                accessor: 'site',
                                show: (this.state.columns.site || {}).selected || false,
                                maxWidth: 200,
                                sortable: false,
                                sortMethod: (a, b) => {
                                    const toSTR = (doc) => {
                                        if (!doc) {
                                            return "";
                                        }
                                        if (doc.site) {
                                            return doc.site;
                                        }
                                        return "";
                                    };
                                    const aSTR = toSTR(a);
                                    const bSTR = toSTR(b);
                                    return aSTR.localeCompare(bSTR);
                                },
                            },
                            {
                                id: 'tags',
                                Header: 'Tags',
                                width: 250,
                                accessor: '',
                                show: this.state.columns.tags.selected,
                                className: 'doc-table-col-tags',
                                sortMethod: (a, b) => {
                                    const toSTR = (obj) => {
                                        if (!obj) {
                                            return "";
                                        }
                                        if (typeof obj === 'string') {
                                            return obj;
                                        }
                                        return JSON.stringify(obj);
                                    };
                                    const cmp = toSTR(a.tags).localeCompare(toSTR(b.tags));
                                    if (cmp !== 0) {
                                        return cmp;
                                    }
                                    return toSTR(a.added).localeCompare(toSTR(b.added));
                                },
                                Cell: (row) => {
                                    const tags = row.original.tags;
                                    const formatted = Object.values(tags)
                                        .map(tag => tag.label)
                                        .sort()
                                        .join(", ");
                                    return (React.createElement("div", null, formatted));
                                }
                            },
                            {
                                id: 'nrAnnotations',
                                Header: 'Annotations',
                                accessor: 'nrAnnotations',
                                maxWidth: 110,
                                show: this.state.columns.nrAnnotations.selected,
                                defaultSortDesc: true,
                                resizable: false,
                            },
                            {
                                id: 'progress',
                                Header: 'Progress',
                                accessor: 'progress',
                                show: this.state.columns.progress.selected,
                                maxWidth: 100,
                                defaultSortDesc: true,
                                resizable: false,
                                className: 'doc-table-col-progress',
                                Cell: (row) => (React.createElement("progress", { className: "mt-auto mb-auto", max: "100", value: row.value, style: {
                                        width: '100%'
                                    } }))
                            },
                            {
                                id: 'doc-buttons',
                                Header: '',
                                accessor: '',
                                maxWidth: 100,
                                defaultSortDesc: true,
                                resizable: false,
                                sortable: false,
                                className: 'doc-dropdown',
                                Cell: (row) => {
                                    const repoDocInfo = row.original;
                                    const existingTags = Object.values(Optional_1.Optional.of(repoDocInfo.docInfo.tags).getOrElse({}));
                                    return (React.createElement("div", { className: "doc-buttons", style: { display: 'flex' } },
                                        React.createElement(DocButton_1.DocButton, null,
                                            React.createElement(TagInput_1.TagInput, { availableTags: this.props.repoDocMetaManager.tagsDB.tags(), existingTags: existingTags, relatedTags: this.props.repoDocMetaManager.relatedTags, onChange: (tags) => this.onDocTagged(repoDocInfo, tags)
                                                    .catch(err => log.error("Unable to update tags: ", err)) })),
                                        React.createElement(FlagDocButton_1.FlagDocButton, { active: repoDocInfo.flagged, onClick: () => this.doHandleToggleField(repoDocInfo, 'flagged') }),
                                        React.createElement(ArchiveDocButton_1.ArchiveDocButton, { active: repoDocInfo.archived, onClick: () => this.doHandleToggleField(repoDocInfo, 'archived') }),
                                        React.createElement(DocButton_1.DocButton, null,
                                            React.createElement(DocDropdown_1.DocDropdown, { id: 'doc-dropdown-' + row.index, repoDocInfo: repoDocInfo, onDelete: this.onDocDeleted, onSetTitle: this.onDocSetTitle }))));
                                }
                            }
                        ], defaultPageSize: 50, noDataText: "No documents available.", className: "-striped -highlight", defaultSorted: [
                            {
                                id: "progress",
                                desc: true
                            }
                        ], getTrProps: (state, rowInfo) => {
                            return {
                                'data-doc-fingerprint': ((rowInfo || {}).original || {}).fingerprint || '',
                                style: {
                                    background: rowInfo && this.state.selected.includes(rowInfo.viewIndex) ? 'var(--selected-background-color)' : 'var(--primary-background-color)',
                                    color: rowInfo && this.state.selected.includes(rowInfo.viewIndex) ? 'var(--selected-text-color)' : 'var(--primary-text-color)',
                                }
                            };
                        }, getTdProps: (state, rowInfo, column, instance) => {
                            const SINGLE_CLICK_COLUMNS = [
                                'tag-input',
                                'flagged',
                                'archived',
                                'doc-dropdown',
                                'doc-buttons',
                                'doc-checkbox'
                            ];
                            if (!SINGLE_CLICK_COLUMNS.includes(column.id)) {
                                return {
                                    onDoubleClick: (event) => {
                                        if (rowInfo) {
                                            this.onDocumentLoadRequested(rowInfo.original.fingerprint, rowInfo.original.filename, rowInfo.original.hashcode);
                                        }
                                    },
                                    onClick: (event, handleOriginal) => {
                                        if (rowInfo) {
                                            this.selectRow(rowInfo.viewIndex, event);
                                        }
                                    },
                                };
                            }
                            if (SINGLE_CLICK_COLUMNS.includes(column.id)) {
                                return {
                                    onClick: ((e, handleOriginal) => {
                                        if (handleOriginal) {
                                            handleOriginal();
                                        }
                                    })
                                };
                            }
                            return {};
                        } })))));
    }
    onDocTagged(repoDocInfo, tags) {
        return __awaiter(this, void 0, void 0, function* () {
            RendererAnalytics_1.RendererAnalytics.event({ category: 'user', action: 'doc-tagged' });
            yield this.props.repoDocMetaManager.writeDocInfoTags(repoDocInfo, tags);
            this.refresh();
        });
    }
    onDocDeleted(repoDocInfo) {
        RendererAnalytics_1.RendererAnalytics.event({ category: 'user', action: 'doc-deleted' });
        log.info("Deleting document: ", repoDocInfo);
        this.props.repoDocMetaManager.deleteDocInfo(repoDocInfo)
            .catch(err => log.error("Could not delete doc: ", err));
        this.refresh();
    }
    onDocSetTitle(repoDocInfo, title) {
        RendererAnalytics_1.RendererAnalytics.event({ category: 'user', action: 'set-doc-title' });
        log.info("Setting doc title: ", title);
        this.props.repoDocMetaManager.writeDocInfoTitle(repoDocInfo, title)
            .catch(err => log.error("Could not write doc title: ", err));
        this.refresh();
    }
    onSelectedColumns(columns) {
        RendererAnalytics_1.RendererAnalytics.event({ category: 'user', action: 'selected-columns' });
        SettingsStore_1.SettingsStore.load()
            .then((settingsProvider) => {
            const currentSettings = settingsProvider();
            const settings = Object.assign({}, currentSettings, { documentRepository: {
                    columns: this.state.columns
                } });
            SettingsStore_1.SettingsStore.write(settings)
                .catch(err => log.error(err));
        })
            .catch(err => log.error("Could not load settings: ", err));
        this.refresh();
    }
    onFilterByTitle(title) {
        RendererAnalytics_1.RendererAnalytics.event({ category: 'user', action: 'filter-by-title' });
        this.filteredRepoDocInfoIndex.onFilterByTitle(title);
    }
    refresh() {
        this.filteredRepoDocInfoIndex.refresh();
    }
    doRefresh(data) {
        const state = Object.assign({}, this.state, { data });
        setTimeout(() => {
            this.setState(state);
        }, 1);
    }
    onDocumentLoadRequested(fingerprint, filename, hashcode) {
        if (!AppRuntime_1.AppRuntime.isElectron() && filename.endsWith(".phz")) {
            const message = `Captured web pages (phz files) are only supported in the web preview version of Polar (please use the desktop version).`;
            const title = "Captured web pages not supported.";
            Toaster_1.Toaster.error(message, title);
            return;
        }
        this.synchronizingDocLoader.load(fingerprint, filename, hashcode)
            .catch(err => log.error("Unable to load doc: ", err));
    }
    doHandleToggleField(repoDocInfo, field) {
        this.handleToggleField(repoDocInfo, field)
            .catch(err => log.error(`Could not handle toggle on field: ${field}: `, err));
    }
    handleToggleField(repoDocInfo, field) {
        return __awaiter(this, void 0, void 0, function* () {
            let mutated = false;
            if (field === 'archived') {
                RendererAnalytics_1.RendererAnalytics.event({ category: 'user', action: 'archived-doc' });
                repoDocInfo.archived = !repoDocInfo.archived;
                repoDocInfo.docInfo.archived = repoDocInfo.archived;
                mutated = true;
            }
            if (field === 'flagged') {
                RendererAnalytics_1.RendererAnalytics.event({ category: 'user', action: 'flagged-doc' });
                repoDocInfo.flagged = !repoDocInfo.flagged;
                repoDocInfo.docInfo.flagged = repoDocInfo.flagged;
                mutated = true;
            }
            if (mutated) {
                yield this.props.repoDocMetaManager.writeDocInfo(repoDocInfo.docInfo);
                this.refresh();
            }
        });
    }
    onToggleFlaggedOnly(value) {
        this.filteredRepoDocInfoIndex.onToggleFlaggedOnly(value);
    }
    onToggleFilterArchived(value) {
        this.filteredRepoDocInfoIndex.onToggleFilterArchived(value);
    }
    cmdImportFromDisk() {
        RendererAnalytics_1.RendererAnalytics.event({ category: 'add-content', action: 'import-from-disk' });
        this.getController().cmdImport()
            .catch((err) => log.error("Could not import from disk: ", err));
    }
    cmdCaptureWebPage() {
        RendererAnalytics_1.RendererAnalytics.event({ category: 'add-content', action: 'capture-web-page' });
        this.getController().cmdCaptureWebPageWithBrowser()
            .catch((err) => log.error("Could not capture page: ", err));
    }
    getController() {
        return electron_1.remote.getGlobal('mainAppController');
    }
}
DocRepoTable.hasSentInitAnalyitics = false;
exports.default = DocRepoTable;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRG9jUmVwb1RhYmxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiRG9jUmVwb1RhYmxlLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDZDQUErQjtBQUMvQiw4REFBMEQ7QUFDMUQsNkRBQXdEO0FBSXhELDBDQUFxQztBQUNyQyxrRUFBNkQ7QUFFN0Qsb0VBQTJEO0FBQzNELHVEQUFrRDtBQUNsRCw0REFBdUQ7QUFDdkQsK0VBQTBFO0FBQzFFLG9EQUErQztBQUMvQyxnREFBMkM7QUFDM0MsaUVBQTREO0FBQzVELCtEQUEwRDtBQUMxRCw4RUFBeUU7QUFJekUsNEVBQXlGO0FBR3pGLDhEQUF5RDtBQUN6RCxvR0FBK0Y7QUFDL0YsMkVBQXNFO0FBQ3RFLG1HQUEyRTtBQUMzRSwyREFBc0Q7QUFDdEQsNkRBQXdEO0FBQ3hELCtFQUEwRTtBQUMxRSwyQ0FBc0M7QUFDdEMsMERBQXFEO0FBQ3JELHVDQUFnQztBQUNoQywwQ0FBbUQ7QUFDbkQseURBQW9EO0FBRXBELGlFQUFnRTtBQUNoRSx1REFBa0Q7QUFDbEQsK0RBQTBEO0FBQzFELHFFQUFnRTtBQUNoRSx5RUFBb0U7QUFDcEUseURBQW9EO0FBQ3BELHlFQUF1RjtBQUN2Riw4REFBeUQ7QUFDekQsbUVBQThEO0FBQzlELGlFQUF5QztBQUd6QyxNQUFNLEdBQUcsR0FBRyxlQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7QUFJNUIsTUFBcUIsWUFBYSxTQUFRLGlDQUF1QztJQWM3RSxZQUFZLEtBQWEsRUFBRSxPQUFZO1FBQ25DLEtBQUssQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFUVCxvQkFBZSxHQUFzQyxJQUFJLDZCQUFhLEVBQUUsQ0FBQztRQVd0RixJQUFJLENBQUMsdUJBQXVCLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQztRQUNsRSxJQUFJLENBQUMsc0JBQXNCLEdBQUcsSUFBSSwrQ0FBc0IsQ0FBQyxJQUFJLENB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QkFBNEIsRUFBRTthQUM5QyxLQUFLLENBQUMsQ0FBQyxHQUFVLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsMEJBQTBCLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUUzRSxDQUFDO0lBRU8sYUFBYTtRQUNqQixPQUFPLGlCQUFNLENBQUMsU0FBUyxDQUFDLG1CQUFtQixDQUFDLENBQUM7SUFDakQsQ0FBQzs7QUEvNUJjLGtDQUFxQixHQUFHLEtBQUssQ0FBQztBQUZqRCwrQkFtNkJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFJlYWN0VGFibGUsIHtDb2x1bW5SZW5kZXJQcm9wc30gZnJvbSBcInJlYWN0LXRhYmxlXCI7XG5pbXBvcnQge0xvZ2dlcn0gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL2xvZ2dlci9Mb2dnZXInO1xuaW1wb3J0IHtSZXBvRG9jTWV0YUxvYWRlcn0gZnJvbSAnLi4vUmVwb0RvY01ldGFMb2FkZXInO1xuaW1wb3J0IHtSZXBvRG9jSW5mb30gZnJvbSAnLi4vUmVwb0RvY0luZm8nO1xuaW1wb3J0IHtSZXBvRG9jTWV0YU1hbmFnZXJ9IGZyb20gJy4uL1JlcG9Eb2NNZXRhTWFuYWdlcic7XG5pbXBvcnQge1RhZ0lucHV0fSBmcm9tICcuLi9UYWdJbnB1dCc7XG5pbXBvcnQge09wdGlvbmFsfSBmcm9tICcuLi8uLi8uLi8uLi93ZWIvanMvdXRpbC90cy9PcHRpb25hbCc7XG5pbXBvcnQge1RhZ30gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL3RhZ3MvVGFnJztcbmltcG9ydCB7aXNQcmVzZW50fSBmcm9tICcuLi8uLi8uLi8uLi93ZWIvanMvUHJlY29uZGl0aW9ucyc7XG5pbXBvcnQge1RhZ3N9IGZyb20gJy4uLy4uLy4uLy4uL3dlYi9qcy90YWdzL1RhZ3MnO1xuaW1wb3J0IHtEYXRlVGltZVRhYmxlQ2VsbH0gZnJvbSAnLi4vRGF0ZVRpbWVUYWJsZUNlbGwnO1xuaW1wb3J0IHtSZW5kZXJlckFuYWx5dGljc30gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL2dhL1JlbmRlcmVyQW5hbHl0aWNzJztcbmltcG9ydCB7TWVzc2FnZUJhbm5lcn0gZnJvbSAnLi4vTWVzc2FnZUJhbm5lcic7XG5pbXBvcnQge0RvY0Ryb3Bkb3dufSBmcm9tICcuLi9Eb2NEcm9wZG93bic7XG5pbXBvcnQge0RvY1JlcG9UYWJsZURyb3Bkb3dufSBmcm9tICcuL0RvY1JlcG9UYWJsZURyb3Bkb3duJztcbmltcG9ydCB7RG9jUmVwb1RhYmxlQ29sdW1uc30gZnJvbSAnLi9Eb2NSZXBvVGFibGVDb2x1bW5zJztcbmltcG9ydCB7U2V0dGluZ3NTdG9yZX0gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL2RhdGFzdG9yZS9TZXR0aW5nc1N0b3JlJztcbmltcG9ydCB7UmVwb0RvY0luZm9JbmRleH0gZnJvbSAnLi4vUmVwb0RvY0luZm9JbmRleCc7XG5pbXBvcnQge0lEb2NJbmZvfSBmcm9tICcuLi8uLi8uLi8uLi93ZWIvanMvbWV0YWRhdGEvRG9jSW5mbyc7XG5pbXBvcnQge1N5bmNCYXJQcm9ncmVzc30gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL3VpL3N5bmNfYmFyL1N5bmNCYXInO1xuaW1wb3J0IHtJRXZlbnREaXNwYXRjaGVyLCBTaW1wbGVSZWFjdG9yfSBmcm9tICcuLi8uLi8uLi8uLi93ZWIvanMvcmVhY3Rvci9TaW1wbGVSZWFjdG9yJztcbmltcG9ydCB7UGVyc2lzdGVuY2VMYXllck1hbmFnZXJ9IGZyb20gJy4uLy4uLy4uLy4uL3dlYi9qcy9kYXRhc3RvcmUvUGVyc2lzdGVuY2VMYXllck1hbmFnZXInO1xuaW1wb3J0IHtIYXNoY29kZX0gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL21ldGFkYXRhL0hhc2hjb2RlJztcbmltcG9ydCB7UmVwb0RvY01ldGFMb2FkZXJzfSBmcm9tICcuLi9SZXBvRG9jTWV0YUxvYWRlcnMnO1xuaW1wb3J0IHtQZXJzaXN0ZW5jZUxheWVyTWFuYWdlcnN9IGZyb20gJy4uLy4uLy4uLy4uL3dlYi9qcy9kYXRhc3RvcmUvUGVyc2lzdGVuY2VMYXllck1hbmFnZXJzJztcbmltcG9ydCB7U3luY2hyb25pemluZ0RvY0xvYWRlcn0gZnJvbSAnLi4vdXRpbC9TeW5jaHJvbml6aW5nRG9jTG9hZGVyJztcbmltcG9ydCBSZWxlYXNpbmdSZWFjdENvbXBvbmVudCBmcm9tICcuLi9mcmFtZXdvcmsvUmVsZWFzaW5nUmVhY3RDb21wb25lbnQnO1xuaW1wb3J0IHtBcnJheXN9IGZyb20gJy4uLy4uLy4uLy4uL3dlYi9qcy91dGlsL0FycmF5cyc7XG5pbXBvcnQge051bWJlcnN9IGZyb20gJy4uLy4uLy4uLy4uL3dlYi9qcy91dGlsL051bWJlcnMnO1xuaW1wb3J0IHtTaW1wbGVUb29sdGlwfSBmcm9tICcuLi8uLi8uLi8uLi93ZWIvanMvdWkvdG9vbHRpcC9TaW1wbGVUb29sdGlwJztcbmltcG9ydCB7VGFnQnV0dG9ufSBmcm9tICcuL1RhZ0J1dHRvbic7XG5pbXBvcnQge1JlcG9IZWFkZXJ9IGZyb20gJy4uL3JlcG9faGVhZGVyL1JlcG9IZWFkZXInO1xuaW1wb3J0IHtyZW1vdGV9IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCB7Rml4ZWROYXYsIEZpeGVkTmF2Qm9keX0gZnJvbSAnLi4vRml4ZWROYXYnO1xuaW1wb3J0IHtBZGRDb250ZW50QnV0dG9ufSBmcm9tICcuL0FkZENvbnRlbnRCdXR0b24nO1xuaW1wb3J0IHtMaXN0T3B0aW9uVHlwZX0gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL3VpL2xpc3Rfc2VsZWN0b3IvTGlzdFNlbGVjdG9yJztcbmltcG9ydCB7TlVMTF9GVU5DVElPTn0gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL3V0aWwvRnVuY3Rpb25zJztcbmltcG9ydCB7RG9jQnV0dG9ufSBmcm9tICcuL2RvY19idXR0b25zL0RvY0J1dHRvbic7XG5pbXBvcnQge0ZsYWdEb2NCdXR0b259IGZyb20gJy4vZG9jX2J1dHRvbnMvRmxhZ0RvY0J1dHRvbic7XG5pbXBvcnQge0FyY2hpdmVEb2NCdXR0b259IGZyb20gJy4vZG9jX2J1dHRvbnMvQXJjaGl2ZURvY0J1dHRvbic7XG5pbXBvcnQge011bHRpRGVsZXRlQnV0dG9ufSBmcm9tICcuL211bHRpX2J1dHRvbnMvTXVsdGlEZWxldGVCdXR0b24nO1xuaW1wb3J0IHtEb2NSZXBvRmlsdGVyQmFyfSBmcm9tICcuL0RvY1JlcG9GaWx0ZXJCYXInO1xuaW1wb3J0IHtGaWx0ZXJlZFJlcG9Eb2NJbmZvSW5kZXgsIFJlZnJlc2hlZENhbGxiYWNrfSBmcm9tICcuL0ZpbHRlcmVkUmVwb0RvY0luZm9JbmRleCc7XG5pbXBvcnQge0FwcFJ1bnRpbWV9IGZyb20gJy4uLy4uLy4uLy4uL3dlYi9qcy9BcHBSdW50aW1lJztcbmltcG9ydCB7VG9hc3Rlcn0gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL3VpL3RvYXN0ZXIvVG9hc3Rlcic7XG5pbXBvcnQgSW5wdXQgZnJvbSAncmVhY3RzdHJhcC9saWIvSW5wdXQnO1xuaW1wb3J0IHtTZXR0aW5nc30gZnJvbSAnLi4vLi4vLi4vLi4vd2ViL2pzL2RhdGFzdG9yZS9TZXR0aW5ncyc7XG5cbmNvbnN0IGxvZyA9IExvZ2dlci5jcmVhdGUoKTtcblxuLy8gVE9ETzogZ28gYmFjayB0byBFeHRlbmRlZFJlYWN0VGFibGVcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRG9jUmVwb1RhYmxlIGV4dGVuZHMgUmVsZWFzaW5nUmVhY3RDb21wb25lbnQ8SVByb3BzLCBJU3RhdGU+IHtcblxuICAgIHByaXZhdGUgc3RhdGljIGhhc1NlbnRJbml0QW5hbHlpdGljcyA9IGZhbHNlO1xuXG4gICAgcHJpdmF0ZSByZWFkb25seSBwZXJzaXN0ZW5jZUxheWVyTWFuYWdlcjogUGVyc2lzdGVuY2VMYXllck1hbmFnZXI7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IHN5bmNCYXJQcm9ncmVzczogSUV2ZW50RGlzcGF0Y2hlcjxTeW5jQmFyUHJvZ3Jlc3M+ID0gbmV3IFNpbXBsZVJlYWN0b3IoKTtcblxuICAgIHByaXZhdGUgcmVhZG9ubHkgc3luY2hyb25pemluZ0RvY0xvYWRlcjogU3luY2hyb25pemluZ0RvY0xvYWRlcjtcblxuICAgIHByaXZhdGUgcmVhY3RUYWJsZTogYW55O1xuXG4gICAgcHJpdmF0ZSByZWFkb25seSBmaWx0ZXJlZFJlcG9Eb2NJbmZvSW5kZXg6IEZpbHRlcmVkUmVwb0RvY0luZm9JbmRleDtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMsIGNvbnRleHQ6IGFueSkge1xuICAgICAgICBzdXBlcihwcm9wcywgY29udGV4dCk7XG5cbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZUxheWVyTWFuYWdlciA9IHRoaXMucHJvcHMucGVyc2lzdGVuY2VMYXllck1hbmFnZXI7XG4gICAgICAgIHRoaXMuc3luY2hyb25pemluZ0RvY0xvYWRlciA9IG5ldyBTeW5jaHJvbml6aW5nRG9jTG9hZGVyKHRoaXMucHJvcHMucGVyc2lzdGVuY2VMYXllck1hbmFnZXIpO1xuXG4gICAgICAgIHRoaXMub25Eb2NUYWdnZWQgPSB0aGlzLm9uRG9jVGFnZ2VkLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMub25Eb2NEZWxldGVkID0gdGhpcy5vbkRvY0RlbGV0ZWQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5vbkRvY1NldFRpdGxlID0gdGhpcy5vbkRvY1NldFRpdGxlLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMub25TZWxlY3RlZENvbHVtbnMgPSB0aGlzLm9uU2VsZWN0ZWRDb2x1bW5zLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5vbkZpbHRlckJ5VGl0bGUgPSB0aGlzLm9uRmlsdGVyQnlUaXRsZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLm9uVG9nZ2xlRmlsdGVyQXJjaGl2ZWQgPSB0aGlzLm9uVG9nZ2xlRmlsdGVyQXJjaGl2ZWQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5vblRvZ2dsZUZsYWdnZWRPbmx5ID0gdGhpcy5vblRvZ2dsZUZsYWdnZWRPbmx5LmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5jbGVhclNlbGVjdGVkID0gdGhpcy5jbGVhclNlbGVjdGVkLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5vbk11bHRpVGFnZ2VkID0gdGhpcy5vbk11bHRpVGFnZ2VkLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMub25NdWx0aURlbGV0ZWQgPSB0aGlzLm9uTXVsdGlEZWxldGVkLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5nZXRTZWxlY3RlZCA9IHRoaXMuZ2V0U2VsZWN0ZWQuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLmNtZEltcG9ydEZyb21EaXNrID0gdGhpcy5jbWRJbXBvcnRGcm9tRGlzay5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmNtZENhcHR1cmVXZWJQYWdlID0gdGhpcy5jbWRDYXB0dXJlV2ViUGFnZS5iaW5kKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgICAgIGNvbHVtbnM6IG5ldyBEb2NSZXBvVGFibGVDb2x1bW5zKCksXG4gICAgICAgICAgICBzZWxlY3RlZDogW11cbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBvblJlZnJlc2hlZDogUmVmcmVzaGVkQ2FsbGJhY2sgPSByZXBvRG9jSW5mb3MgPT4gdGhpcy5kb1JlZnJlc2gocmVwb0RvY0luZm9zKTtcblxuICAgICAgICBjb25zdCByZXBvRG9jSW5mb3NQcm92aWRlciA9ICgpID0+IE9iamVjdC52YWx1ZXModGhpcy5wcm9wcy5yZXBvRG9jTWV0YU1hbmFnZXIhLnJlcG9Eb2NJbmZvSW5kZXgpO1xuXG4gICAgICAgIHRoaXMuZmlsdGVyZWRSZXBvRG9jSW5mb0luZGV4ID1cbiAgICAgICAgICAgIG5ldyBGaWx0ZXJlZFJlcG9Eb2NJbmZvSW5kZXgob25SZWZyZXNoZWQsIHJlcG9Eb2NJbmZvc1Byb3ZpZGVyKTtcblxuICAgICAgICB0aGlzLmluaXQoKTtcblxuICAgICAgICB0aGlzLmluaXRBc3luYygpXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IGxvZy5lcnJvcihcIkNvdWxkIG5vdCBpbml0OiBcIiwgZXJyKSk7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXQoKSB7XG5cbiAgICAgICAgLy8gVE9ETzogd2hlbiB3ZSBnZXQgYSBORVcgcGVyc2lzdGVuY2UgbGF5ZXIgd2UgcHJvYmFibHkgbmVlZCB0byByZWxlYXNlXG4gICAgICAgIC8vIHRoZSBvbGQgZXZlbnQgbGlzdGVuZXIgYXMgdGhlIGNvbXBvbmVudCBpcyBzdGlsbCBtb3VudGVkIGJ1dCB0aGUgb2xkXG4gICAgICAgIC8vIHBlcnNpc3RlbmNlIGxheWVyIGhhcyBub3cgZ29uZSBhd2F5LlxuXG4gICAgICAgIFBlcnNpc3RlbmNlTGF5ZXJNYW5hZ2Vycy5vblBlcnNpc3RlbmNlTWFuYWdlcih0aGlzLnByb3BzLnBlcnNpc3RlbmNlTGF5ZXJNYW5hZ2VyLCAocGVyc2lzdGVuY2VMYXllcikgPT4ge1xuXG4gICAgICAgICAgICB0aGlzLnJlbGVhc2VyLnJlZ2lzdGVyKFxuICAgICAgICAgICAgICAgIHBlcnNpc3RlbmNlTGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcigoKSA9PiB0aGlzLnJlZnJlc2goKSkpO1xuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucmVsZWFzZXIucmVnaXN0ZXIoXG4gICAgICAgICAgICBSZXBvRG9jTWV0YUxvYWRlcnMuYWRkVGhyb3R0bGluZ0V2ZW50TGlzdGVuZXIodGhpcy5wcm9wcy5yZXBvRG9jTWV0YUxvYWRlciwgKCkgPT4gdGhpcy5yZWZyZXNoKCkpKTtcblxuICAgICAgICB0aGlzLnJlbGVhc2VyLnJlZ2lzdGVyKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5yZXBvRG9jTWV0YUxvYWRlci5hZGRFdmVudExpc3RlbmVyKGV2ZW50ID0+IHtcblxuICAgICAgICAgICAgICAgIGlmICghRG9jUmVwb1RhYmxlLmhhc1NlbnRJbml0QW5hbHlpdGljcyAmJiBldmVudC5wcm9ncmVzcy5wcm9ncmVzcyA9PT0gMTAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdEluaXRBbmFseXRpY3ModGhpcy5wcm9wcy5yZXBvRG9jTWV0YU1hbmFnZXIucmVwb0RvY0luZm9JbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIERvY1JlcG9UYWJsZS5oYXNTZW50SW5pdEFuYWx5aXRpY3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgaW5pdEFzeW5jKCk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgICAgIGNvbnN0IHNldHRpbmdQcm92aWRlciA9IGF3YWl0IFNldHRpbmdzU3RvcmUubG9hZCgpO1xuXG4gICAgICAgIGxvZy5pbmZvKFwiU2V0dGluZ3MgbG9hZGVkOiBcIiwgc2V0dGluZ1Byb3ZpZGVyKTtcblxuICAgICAgICBPcHRpb25hbC5vZihzZXR0aW5nUHJvdmlkZXIoKS5kb2N1bWVudFJlcG9zaXRvcnkpXG4gICAgICAgICAgICAubWFwKGN1cnJlbnQgPT4gY3VycmVudC5jb2x1bW5zKVxuICAgICAgICAgICAgLndoZW4oY29sdW1ucyA9PiB7XG5cbiAgICAgICAgICAgICAgICAvLyBjb2x1bW5zID0gT2JqZWN0LmFzc2lnbiggbmV3IERvY1JlcG9UYWJsZUNvbHVtbnMoKSwgY29sdW1ucyk7XG5cbiAgICAgICAgICAgICAgICBsb2cuaW5mbyhcIkxvYWRlZCBjb2x1bW5zIGZyb20gc2V0dGluZ3M6IFwiLCBjb2x1bW5zKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsuLi50aGlzLnN0YXRlLCBjb2x1bW5zfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBlbWl0SW5pdEFuYWx5dGljcyhyZXBvRG9jczogUmVwb0RvY0luZm9JbmRleCkge1xuXG4gICAgICAgIC8vIFRPRE86IG1vdmUgc29tZSBvZiB0aGVzZSBhbmFseXRpY3MgaW50byB0aGUgbWFpbiBSZXBvYWl0b3J5QXBwLnRzeC5cblxuICAgICAgICBjb25zdCBuckRvY3MgPSBPYmplY3Qua2V5cyhyZXBvRG9jcykubGVuZ3RoO1xuXG4gICAgICAgIFJlbmRlcmVyQW5hbHl0aWNzLnNldCh7J25yRG9jcyc6IG5yRG9jc30pO1xuXG4gICAgICAgIGNvbnN0IHBlcnNpc3RlbmNlTGF5ZXJUeXBlID0gdGhpcy5wZXJzaXN0ZW5jZUxheWVyTWFuYWdlci5jdXJyZW50VHlwZSgpO1xuXG4gICAgICAgIFJlbmRlcmVyQW5hbHl0aWNzLmV2ZW50KHtjYXRlZ29yeTogJ2RvY3VtZW50LXJlcG9zaXRvcnknLCBhY3Rpb246IGBkb2NzLWxvYWRlZC0ke3BlcnNpc3RlbmNlTGF5ZXJUeXBlfS0ke25yRG9jc31gfSk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgc2VsZWN0Um93KHNlbGVjdGVkSWR4OiBudW1iZXIsIGV2ZW50OiBNb3VzZUV2ZW50LCBjaGVja2JveDogYm9vbGVhbiA9IGZhbHNlKSB7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBzZWxlY3RlZElkeCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkSWR4ID0gcGFyc2VJbnQoc2VsZWN0ZWRJZHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHNlbGVjdGVkOiBudW1iZXJbXSA9IFtzZWxlY3RlZElkeF07XG5cbiAgICAgICAgaWYgKGV2ZW50LmdldE1vZGlmaWVyU3RhdGUoXCJTaGlmdFwiKSkge1xuXG4gICAgICAgICAgICAvLyBzZWxlY3QgYSByYW5nZVxuXG4gICAgICAgICAgICBsZXQgbWluOiBudW1iZXIgPSAwO1xuICAgICAgICAgICAgbGV0IG1heDogbnVtYmVyID0gMDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2VsZWN0ZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNvcnRlZCA9IFsuLi50aGlzLnN0YXRlLnNlbGVjdGVkXS5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG4gICAgICAgICAgICAgICAgbWluID0gQXJyYXlzLmZpcnN0KHNvcnRlZCkhO1xuICAgICAgICAgICAgICAgIG1heCA9IEFycmF5cy5sYXN0KHNvcnRlZCkhO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZWxlY3RlZCA9IFsuLi5OdW1iZXJzLnJhbmdlKE1hdGgubWluKG1pbiwgc2VsZWN0ZWRJZHgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChtYXgsIHNlbGVjdGVkSWR4KSldO1xuXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzZWxlY3RJbmRpdmlkdWFsID0gKGV2ZW50LmdldE1vZGlmaWVyU3RhdGUoXCJDb250cm9sXCIpIHx8IGV2ZW50LmdldE1vZGlmaWVyU3RhdGUoXCJNZXRhXCIpKSB8fCBjaGVja2JveDtcblxuICAgICAgICBpZiAoc2VsZWN0SW5kaXZpZHVhbCkge1xuXG4gICAgICAgICAgICAvLyBvbmUgYXQgYSB0aW1lXG5cbiAgICAgICAgICAgIHNlbGVjdGVkID0gWy4uLnRoaXMuc3RhdGUuc2VsZWN0ZWRdO1xuXG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWQuaW5jbHVkZXMoc2VsZWN0ZWRJZHgpKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQuc3BsaWNlKHNlbGVjdGVkLmluZGV4T2Yoc2VsZWN0ZWRJZHgpLCAxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSBbLi4uc2VsZWN0ZWQsIHNlbGVjdGVkSWR4XTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Li4udGhpcy5zdGF0ZSwgc2VsZWN0ZWR9KTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgb25NdWx0aVRhZ2dlZCh0YWdzOiBUYWdbXSkge1xuXG4gICAgICAgIGNvbnN0IHJlcG9Eb2NJbmZvcyA9IHRoaXMuZ2V0U2VsZWN0ZWQoKTtcblxuICAgICAgICBmb3IgKGNvbnN0IHJlcG9Eb2NJbmZvIG9mIHJlcG9Eb2NJbmZvcykge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdUYWdzID0gT2JqZWN0LnZhbHVlcyhyZXBvRG9jSW5mby50YWdzIHx8IHt9KTtcbiAgICAgICAgICAgIGNvbnN0IGVmZmVjdFRhZ3MgPSBUYWdzLnVuaW9uKGV4aXN0aW5nVGFncywgdGFncyB8fCBbXSk7XG5cbiAgICAgICAgICAgIHRoaXMub25Eb2NUYWdnZWQocmVwb0RvY0luZm8sIGVmZmVjdFRhZ3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBsb2cuZXJyb3IoZXJyKSk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbk11bHRpRGVsZXRlZCgpIHtcblxuICAgICAgICBjb25zdCByZXBvRG9jSW5mb3MgPSB0aGlzLmdldFNlbGVjdGVkKCk7XG5cbiAgICAgICAgZm9yIChjb25zdCByZXBvRG9jSW5mbyBvZiByZXBvRG9jSW5mb3MpIHtcbiAgICAgICAgICAgIHRoaXMub25Eb2NEZWxldGVkKHJlcG9Eb2NJbmZvKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2xlYXJTZWxlY3RlZCgpO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbGVhclNlbGVjdGVkKCkge1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Li4udGhpcy5zdGF0ZSwgc2VsZWN0ZWQ6IFtdfSk7XG4gICAgICAgIH0sIDEpO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRTZWxlY3RlZCgpOiBSZXBvRG9jSW5mb1tdIHtcblxuICAgICAgICBjb25zdCByZXNvbHZlZFN0YXRlID0gdGhpcy5yZWFjdFRhYmxlIS5nZXRSZXNvbHZlZFN0YXRlKCk7XG5cbiAgICAgICAgY29uc3Qgc29ydGVkRGF0YSA9IHJlc29sdmVkU3RhdGUuc29ydGVkRGF0YTtcblxuICAgICAgICBjb25zdCByZXN1bHQ6IFJlcG9Eb2NJbmZvW10gPVxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZFxuICAgICAgICAgICAgICAgIC5tYXAoc2VsZWN0ZWRJZHggPT4gc29ydGVkRGF0YVtzZWxlY3RlZElkeF0pXG4gICAgICAgICAgICAgICAgLmZpbHRlcihpdGVtID0+IGlzUHJlc2VudChpdGVtKSlcbiAgICAgICAgICAgICAgICAubWFwKGl0ZW0gPT4gaXRlbS5fb3JpZ2luYWwpO1xuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7IGRhdGEgfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIHJldHVybiAoXG5cbiAgICAgICAgICAgIDxGaXhlZE5hdiBpZD1cImRvYy1yZXBvLXRhYmxlXCI+XG5cbiAgICAgICAgICAgICAgICA8aGVhZGVyPlxuXG4gICAgICAgICAgICAgICAgICAgIDxSZXBvSGVhZGVyIHBlcnNpc3RlbmNlTGF5ZXJNYW5hZ2VyPXt0aGlzLnByb3BzLnBlcnNpc3RlbmNlTGF5ZXJNYW5hZ2VyfS8+XG5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD1cImhlYWRlci1maWx0ZXJcIj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e2Rpc3BsYXk6ICdmbGV4J319PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiAnbm93cmFwJywgbWFyZ2luVG9wOiAnYXV0bycsIG1hcmdpbkJvdHRvbTogJ2F1dG8nLCBkaXNwbGF5OiAnZmxleCd9fT5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1yLTFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2hpdGVTcGFjZTogJ25vd3JhcCcsIG1hcmdpblRvcDogJ2F1dG8nLCBtYXJnaW5Cb3R0b206ICdhdXRvJ319PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWRkQ29udGVudEJ1dHRvbiBpbXBvcnRGcm9tRGlzaz17KCkgPT4gdGhpcy5jbWRJbXBvcnRGcm9tRGlzaygpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FwdHVyZVdlYlBhZ2U9e3RoaXMuY21kQ2FwdHVyZVdlYlBhZ2V9Lz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXItMVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiAnbm93cmFwJywgbWFyZ2luVG9wOiAnYXV0bycsIG1hcmdpbkJvdHRvbTogJ2F1dG8nfX0+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tkaXNwbGF5OiB0aGlzLnN0YXRlLnNlbGVjdGVkLmxlbmd0aCA8PSAxID8gJ25vbmUnIDogJ2ZsZXgnfX0+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Lyo8RmlsdGVyVGFnSW5wdXQgdGFnc0RCUHJvdmlkZXI9eygpID0+IHRoaXMucHJvcHMucmVwb0RvY01ldGFNYW5hZ2VyIS50YWdzREJ9Ki99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKnJlZnJlc2hlcj17KCkgPT4gdGhpcy5yZWZyZXNoKCl9Ki99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKmRpc2FibGVkPXt0aGlzLnN0YXRlLnNlbGVjdGVkLmxlbmd0aCA9PT0gMH0qL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgey8qZmlsdGVyZWRUYWdzPXt0aGlzLmZpbHRlcmVkVGFnc30gLz4qL31cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhZ0J1dHRvbiBpZD1cInRhZy1tdWx0aXBsZS1kb2N1bWVudHNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NEQlByb3ZpZGVyPXsoKSA9PiB0aGlzLnByb3BzLnJlcG9Eb2NNZXRhTWFuYWdlciEudGFnc0RCfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0ZWRUYWdzPXt0YWdzID0+IHRoaXMub25NdWx0aVRhZ2dlZCh0YWdzKX0vPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTaW1wbGVUb29sdGlwIHRhcmdldD1cInRhZy1tdWx0aXBsZS1kb2N1bWVudHNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJib3R0b21cIj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFnIG11bHRpcGxlIGRvY3VtZW50cyBhdCBvbmNlLiAgVG9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmQgdW50YWdnZWQgZG9jdW1lbnRzIHNvcnQgYnkgdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVGFncycgY29sdW1uICh0d2ljZSkuICBPbmNlIHRvIHNvcnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhYmV0aWNhbGx5IGFuZCB0aGVuIHNlY29uZCBjbGlja1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lsbCByZXZlcnNlIHRoZSBzb3J0IHNob3dpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVudGFnZ2VkIGRvY3VtZW50cy5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NpbXBsZVRvb2x0aXA+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWwtMVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TXVsdGlEZWxldGVCdXR0b24gb25DYW5jZWw9e05VTExfRlVOQ1RJT059XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNvbmZpcm09eygpID0+IHRoaXMub25NdWx0aURlbGV0ZWQoKX0vPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e21hcmdpbkxlZnQ6ICdhdXRvJ319PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEb2NSZXBvRmlsdGVyQmFyIG9uVG9nZ2xlRmxhZ2dlZE9ubHk9e3ZhbHVlID0+IHRoaXMub25Ub2dnbGVGbGFnZ2VkT25seSh2YWx1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVG9nZ2xlRmlsdGVyQXJjaGl2ZWQ9e3ZhbHVlID0+IHRoaXMub25Ub2dnbGVGaWx0ZXJBcmNoaXZlZCh2YWx1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRmlsdGVyQnlUaXRsZT17KHRpdGxlKSA9PiB0aGlzLm9uRmlsdGVyQnlUaXRsZSh0aXRsZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NEQlByb3ZpZGVyPXsoKSA9PiB0aGlzLnByb3BzLnJlcG9Eb2NNZXRhTWFuYWdlciEudGFnc0RCfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoZXI9eygpID0+IHRoaXMucmVmcmVzaCgpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZFRhZ3M9e3RoaXMuZmlsdGVyZWRSZXBvRG9jSW5mb0luZGV4LmZpbHRlcnMuZmlsdGVyZWRUYWdzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3doaXRlU3BhY2U6ICdub3dyYXAnLCBtYXJnaW5Ub3A6ICdhdXRvJywgbWFyZ2luQm90dG9tOiAnYXV0byd9fT5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERvY1JlcG9UYWJsZURyb3Bkb3duIGlkPVwidGFibGUtZHJvcGRvd25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9e09iamVjdC52YWx1ZXModGhpcy5zdGF0ZS5jb2x1bW5zKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNlbGVjdGVkQ29sdW1ucz17KHNlbGVjdGVkQ29sdW1ucykgPT4gdGhpcy5vblNlbGVjdGVkQ29sdW1ucyhzZWxlY3RlZENvbHVtbnMpfS8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICA8TWVzc2FnZUJhbm5lci8+XG5cbiAgICAgICAgICAgICAgICA8L2hlYWRlcj5cblxuICAgICAgICAgICAgICAgIDxGaXhlZE5hdkJvZHk+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9XCJkb2MtdGFibGVcIiBzdHlsZT17e2hlaWdodDogJzEwMCUnfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8UmVhY3RUYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE9e2RhdGF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXsocjogYW55KSA9PiB0aGlzLnJlYWN0VGFibGUgPSByfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbnM9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2RvYy1jaGVja2JveCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGVhZGVyOiAoY29sOiBDb2x1bW5SZW5kZXJQcm9wcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBtb3ZlIHRvIGEgUHVyZUNvbXBvbmVudCB0b1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbXByb3ZlIHBlcmZvcm1hbmNlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hlY2tlZCA9IHRoaXMuc3RhdGUuc2VsZWN0ZWQubGVuZ3RoID09PSBjb2wuZGF0YS5sZW5ndGggJiYgY29sLmRhdGEubGVuZ3RoID4gMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKDxkaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dCBjaGVja2VkPXtjaGVja2VkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbkxlZnQ6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luUmlnaHQ6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAnYXV0bycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICcycHgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogJzE2cHgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICcxNnB4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm0tYXV0b1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e05VTExfRlVOQ1RJT059XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBub29wLi4uIG5vdyBkbyB3ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxlY3QgQUxMIHRoZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdGVtcyBpbiB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RhdGUgbm93XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29tcHV0ZVNlbGVjdGVkID0gKCk6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLnNlbGVjdGVkLmxlbmd0aCAhPT0gY29sLmRhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWxsIG9mXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBOdW1iZXJzLnJhbmdlKDAsIGNvbC5kYXRhLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBub25lIG9mXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gY29tcHV0ZVNlbGVjdGVkKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Li4udGhpcy5zdGF0ZSwgc2VsZWN0ZWR9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCIvPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2Nlc3NvcjogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGg6IDI1LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRTb3J0RGVzYzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNpemFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkb2MtY2hlY2tib3gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENlbGw6IChyb3c6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBtb3ZlIHRvIGEgUHVyZUNvbXBvbmVudCB0b1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbXByb3ZlIHBlcmZvcm1hbmNlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgdmlld0luZGV4ID0gcm93LnZpZXdJbmRleCBhcyBudW1iZXI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICg8ZGl2IHN0eWxlPXt7bGluZUhlaWdodDogJzFlbSd9fT5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPElucHV0IGNoZWNrZWQ9e3RoaXMuc3RhdGUuc2VsZWN0ZWQuaW5jbHVkZXModmlld0luZGV4KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5MZWZ0OiAnYXV0bycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiAnYXV0bycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbjogJ2F1dG8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAnMnB4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICcxNnB4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAnMTZweCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtLWF1dG9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtOVUxMX0ZVTkNUSU9OfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhldmVudCkgPT4gdGhpcy5zZWxlY3RSb3codmlld0luZGV4LCBldmVudC5uYXRpdmVFdmVudCwgdHJ1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCIvPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Lyo8aSBjbGFzc05hbWU9XCJmYXIgZmEtc3F1YXJlXCI+PC9pPiovfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIZWFkZXI6ICdUaXRsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzb3I6ICd0aXRsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZG9jLXRhYmxlLWNvbC10aXRsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2VsbDogKHJvdzogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gJ2RvYy1yZXBvLXJvdy10aXRsZScgKyByb3cuaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPXtpZH0+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2Pntyb3cudmFsdWV9PC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7LypUT0RPOiB0aGlzIGRvZXNuJ3QgcmVsaWFibHkgd29yayBhcyovfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKm1vdmluZyB0aGUgbW91c2UgaG9yaXpvbnRhbGx5IHdpdGhpbiovfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKnRoZSB0YXJnZXQgZG9lc24ndCBjbG9zZSB0aGUgdG9vbHRpcC4qL31cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKjxVbmNvbnRyb2xsZWRUb29sdGlwIHN0eWxlPXt7bWF4V2lkdGg6ICcxMDAwcHgnfX0qL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7LypwbGFjZW1lbnQ9XCJib3R0b21cIiovfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKmRlbGF5PXt7c2hvdzogNzUwLCBoaWRlOiAwfX0qL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Lyp0YXJnZXQ9e2lkfT4qL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Lyo8Q29sbGFwc2UgdGltZW91dD17eyBlbnRlcjogMCwgZXhpdDogMCB9fSA+Ki99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgey8qe3Jvdy52YWx1ZX0qL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Lyo8L0NvbGxhcHNlPiovfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgey8qPC9VbmNvbnRyb2xsZWRUb29sdGlwPiovfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIZWFkZXI6ICdVcGRhdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhY2Nlc3NvcjogKHJvdzogYW55KSA9PiByb3cuYWRkZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzb3I6ICdsYXN0VXBkYXRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogdGhpcy5zdGF0ZS5jb2x1bW5zLmxhc3RVcGRhdGVkLnNlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiA4NSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U29ydERlc2M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZG9jLXRhYmxlLWNvbC11cGRhdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDZWxsOiAocm93OiBhbnkpID0+IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERhdGVUaW1lVGFibGVDZWxsIGNsYXNzTmFtZT1cImRvYy1jb2wtbGFzdC11cGRhdGVkXCIgZGF0ZXRpbWU9e3Jvdy52YWx1ZX0vPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIZWFkZXI6ICdBZGRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzb3I6ICdhZGRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogdGhpcy5zdGF0ZS5jb2x1bW5zLmFkZGVkLnNlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiA4NSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U29ydERlc2M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZG9jLXRhYmxlLWNvbC1hZGRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2VsbDogKHJvdzogYW55KSA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEYXRlVGltZVRhYmxlQ2VsbCBjbGFzc05hbWU9XCJkb2MtY29sLWFkZGVkXCIgZGF0ZXRpbWU9e3Jvdy52YWx1ZX0vPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGVhZGVyOiAnU2l0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzb3I6ICdzaXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiAodGhpcy5zdGF0ZS5jb2x1bW5zLnNpdGUgfHwge30pLnNlbGVjdGVkIHx8IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3c6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiAyMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRNZXRob2Q6IChhOiBSZXBvRG9jSW5mbywgYjogUmVwb0RvY0luZm8pID0+IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b1NUUiA9IChkb2M/OiBSZXBvRG9jSW5mbyk6IHN0cmluZyA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIGRvYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLnNpdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jLnNpdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYVNUUiA9IHRvU1RSKGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiU1RSID0gdG9TVFIoYik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKGFTVFIgPT09IGJTVFIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIChhU1RSID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICByZXR1cm4gTnVtYmVyLk1JTl9WQUxVRTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAoYlNUUiA9PT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIE51bWJlci5NQVhfVkFMVUU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVNUUi5sb2NhbGVDb21wYXJlKGJTVFIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIE1vbWVudChkLnVwZGF0ZWRfYXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIC5sb2NhbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIC5mb3JtYXQoXCJERC1NTS1ZWVlZIGhoOm1tOnNzIGFcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIEhlYWRlcjogJ0xhc3QgTmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgaWQ6ICdsYXN0TmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgYWNjZXNzb3I6IChkOiBhbnkpID0+IGQubGFzdE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICd0YWdzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIZWFkZXI6ICdUYWdzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMjUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2Vzc29yOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB0aGlzLnN0YXRlLmNvbHVtbnMudGFncy5zZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkb2MtdGFibGUtY29sLXRhZ3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRNZXRob2Q6IChhOiBSZXBvRG9jSW5mbywgYjogUmVwb0RvY0luZm8pID0+IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b1NUUiA9IChvYmo6IGFueSk6IHN0cmluZyA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNtcCA9IHRvU1RSKGEudGFncykubG9jYWxlQ29tcGFyZSh0b1NUUihiLnRhZ3MpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY21wICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY21wO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIHRpZXMgdXNlIHRoZSBkYXRlIGFkZGVkLi4uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0b1NUUihhLmFkZGVkKS5sb2NhbGVDb21wYXJlKHRvU1RSKGIuYWRkZWQpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2VsbDogKHJvdzogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IG1vdmUgdG8gYSBQdXJlQ29tcG9uZW50IHRvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGltcHJvdmUgcGVyZm9ybWFuY2VcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdzOiB7W2lkOiBzdHJpbmddOiBUYWd9ID0gcm93Lm9yaWdpbmFsLnRhZ3M7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gT2JqZWN0LnZhbHVlcyh0YWdzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCh0YWcgPT4gdGFnLmxhYmVsKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNvcnQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oXCIsIFwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj57Zm9ybWF0dGVkfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ25yQW5ub3RhdGlvbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhlYWRlcjogJ0Fubm90YXRpb25zJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2Nlc3NvcjogJ25yQW5ub3RhdGlvbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiAxMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogdGhpcy5zdGF0ZS5jb2x1bW5zLm5yQW5ub3RhdGlvbnMuc2VsZWN0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFNvcnREZXNjOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAncHJvZ3Jlc3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhlYWRlcjogJ1Byb2dyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2Nlc3NvcjogJ3Byb2dyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB0aGlzLnN0YXRlLmNvbHVtbnMucHJvZ3Jlc3Muc2VsZWN0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGg6IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U29ydERlc2M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkb2MtdGFibGUtY29sLXByb2dyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDZWxsOiAocm93OiBhbnkpID0+IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogbW92ZSB0byBhIFB1cmVDb21wb25lbnQgdG9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW1wcm92ZSBwZXJmb3JtYW5jZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwcm9ncmVzcyBjbGFzc05hbWU9XCJtdC1hdXRvIG1iLWF1dG9cIiBtYXg9XCIxMDBcIiB2YWx1ZT17IHJvdy52YWx1ZSB9IHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogJzEwMCUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19IC8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAnZG9jLWJ1dHRvbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhlYWRlcjogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzb3I6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFNvcnREZXNjOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2RvYy1kcm9wZG93bicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2VsbDogKHJvdzogYW55KSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogbW92ZSB0byBhIFB1cmVDb21wb25lbnQgdG9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW1wcm92ZSBwZXJmb3JtYW5jZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcG9Eb2NJbmZvOiBSZXBvRG9jSW5mbyA9IHJvdy5vcmlnaW5hbDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ1RhZ3M6IFRhZ1tdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IE9iamVjdC52YWx1ZXMoT3B0aW9uYWwub2YocmVwb0RvY0luZm8uZG9jSW5mby50YWdzKS5nZXRPckVsc2Uoe30pKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKDxkaXYgY2xhc3NOYW1lPVwiZG9jLWJ1dHRvbnNcIiBzdHlsZT17e2Rpc3BsYXk6ICdmbGV4J319PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERvY0J1dHRvbj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7LypXQVJOSU5HOiBtYWtpbmcgdGhpcyBhIGZ1bmN0aW9uIGJyZWFrcyB0aGUgbGF5b3V0Li4uKi99XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhZ0lucHV0IGF2YWlsYWJsZVRhZ3M9e3RoaXMucHJvcHMucmVwb0RvY01ldGFNYW5hZ2VyIS50YWdzREIudGFncygpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdUYWdzPXtleGlzdGluZ1RhZ3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkVGFncz17dGhpcy5wcm9wcy5yZXBvRG9jTWV0YU1hbmFnZXIhLnJlbGF0ZWRUYWdzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyh0YWdzKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25Eb2NUYWdnZWQocmVwb0RvY0luZm8sIHRhZ3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gbG9nLmVycm9yKFwiVW5hYmxlIHRvIHVwZGF0ZSB0YWdzOiBcIiwgZXJyKSl9Lz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvRG9jQnV0dG9uPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEZsYWdEb2NCdXR0b24gYWN0aXZlPXtyZXBvRG9jSW5mby5mbGFnZ2VkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMuZG9IYW5kbGVUb2dnbGVGaWVsZChyZXBvRG9jSW5mbywgJ2ZsYWdnZWQnKX0vPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFyY2hpdmVEb2NCdXR0b24gYWN0aXZlPXtyZXBvRG9jSW5mby5hcmNoaXZlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLmRvSGFuZGxlVG9nZ2xlRmllbGQocmVwb0RvY0luZm8sICdhcmNoaXZlZCcpfS8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RG9jQnV0dG9uPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEb2NEcm9wZG93biBpZD17J2RvYy1kcm9wZG93bi0nICsgcm93LmluZGV4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb0RvY0luZm89e3JlcG9Eb2NJbmZvfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25EZWxldGU9e3RoaXMub25Eb2NEZWxldGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TZXRUaXRsZT17dGhpcy5vbkRvY1NldFRpdGxlfS8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0RvY0J1dHRvbj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFBhZ2VTaXplPXs1MH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub0RhdGFUZXh0PVwiTm8gZG9jdW1lbnRzIGF2YWlsYWJsZS5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIi1zdHJpcGVkIC1oaWdobGlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRTb3J0ZWQ9e1tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IFwicHJvZ3Jlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc29ydGVkPXtbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBpZDogJ2FkZGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgZGVzYzogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1dfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFRyUHJvcHM9eyhzdGF0ZTogYW55LCByb3dJbmZvOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5jbHVkZSB0aGUgZG9jIGZpbmdlcnByaW50IGluIHRoZSB0YWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gdGhhdCB0aGUgdG91ciBjYW4gdXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS1kb2MtZmluZ2VycHJpbnQnOiAoKHJvd0luZm8gfHwge30pLm9yaWdpbmFsIHx8IHt9KS5maW5nZXJwcmludCB8fCAnJyxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBkYXJrLW1vZGUuICBVc2UgQ1NTIHZhcmlhYmxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmFtZXMgZm9yIGNvbG9yc1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogcm93SW5mbyAmJiB0aGlzLnN0YXRlLnNlbGVjdGVkLmluY2x1ZGVzKHJvd0luZm8udmlld0luZGV4KSA/ICd2YXIoLS1zZWxlY3RlZC1iYWNrZ3JvdW5kLWNvbG9yKScgOiAndmFyKC0tcHJpbWFyeS1iYWNrZ3JvdW5kLWNvbG9yKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IHJvd0luZm8gJiYgdGhpcy5zdGF0ZS5zZWxlY3RlZC5pbmNsdWRlcyhyb3dJbmZvLnZpZXdJbmRleCkgPyAndmFyKC0tc2VsZWN0ZWQtdGV4dC1jb2xvciknIDogJ3ZhcigtLXByaW1hcnktdGV4dC1jb2xvciknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRUZFByb3BzPXsoc3RhdGU6IGFueSwgcm93SW5mbzogYW55LCBjb2x1bW46IGFueSwgaW5zdGFuY2U6IGFueSkgPT4ge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFNJTkdMRV9DTElDS19DT0xVTU5TID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RhZy1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmxhZ2dlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYXJjaGl2ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RvYy1kcm9wZG93bicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZG9jLWJ1dHRvbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RvYy1jaGVja2JveCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISBTSU5HTEVfQ0xJQ0tfQ09MVU1OUy5pbmNsdWRlcyhjb2x1bW4uaWQpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkRvdWJsZUNsaWNrOiAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93SW5mbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRvY3VtZW50TG9hZFJlcXVlc3RlZChyb3dJbmZvLm9yaWdpbmFsLmZpbmdlcnByaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJbmZvLm9yaWdpbmFsLmZpbGVuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJbmZvLm9yaWdpbmFsLmhhc2hjb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IChldmVudDogTW91c2VFdmVudCwgaGFuZGxlT3JpZ2luYWw/OiAoKSA9PiB2b2lkKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0luZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93KHJvd0luZm8udmlld0luZGV4IGFzIG51bWJlciwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoU0lOR0xFX0NMSUNLX0NPTFVNTlMuaW5jbHVkZXMoY29sdW1uLmlkKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljazogKChlOiBhbnksIGhhbmRsZU9yaWdpbmFsPzogKCkgPT4gdm9pZCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVPcmlnaW5hbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmVlZGVkIGZvciByZWFjdCB0YWJsZSB0b1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZnVuY3Rpb24gcHJvcGVybHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVPcmlnaW5hbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge307XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDwvRml4ZWROYXZCb2R5PlxuXG5cbiAgICAgICAgICAgIDwvRml4ZWROYXY+XG5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIG9uRG9jVGFnZ2VkKHJlcG9Eb2NJbmZvOiBSZXBvRG9jSW5mbywgdGFnczogVGFnW10pIHtcblxuICAgICAgICBSZW5kZXJlckFuYWx5dGljcy5ldmVudCh7Y2F0ZWdvcnk6ICd1c2VyJywgYWN0aW9uOiAnZG9jLXRhZ2dlZCd9KTtcblxuICAgICAgICBhd2FpdCB0aGlzLnByb3BzLnJlcG9Eb2NNZXRhTWFuYWdlciEud3JpdGVEb2NJbmZvVGFncyhyZXBvRG9jSW5mbywgdGFncyk7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkRvY0RlbGV0ZWQocmVwb0RvY0luZm86IFJlcG9Eb2NJbmZvKSB7XG5cbiAgICAgICAgUmVuZGVyZXJBbmFseXRpY3MuZXZlbnQoe2NhdGVnb3J5OiAndXNlcicsIGFjdGlvbjogJ2RvYy1kZWxldGVkJ30pO1xuXG4gICAgICAgIGxvZy5pbmZvKFwiRGVsZXRpbmcgZG9jdW1lbnQ6IFwiLCByZXBvRG9jSW5mbyk7XG5cbiAgICAgICAgdGhpcy5wcm9wcy5yZXBvRG9jTWV0YU1hbmFnZXIuZGVsZXRlRG9jSW5mbyhyZXBvRG9jSW5mbylcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gbG9nLmVycm9yKFwiQ291bGQgbm90IGRlbGV0ZSBkb2M6IFwiLCBlcnIpKTtcblxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgb25Eb2NTZXRUaXRsZShyZXBvRG9jSW5mbzogUmVwb0RvY0luZm8sIHRpdGxlOiBzdHJpbmcpIHtcblxuICAgICAgICBSZW5kZXJlckFuYWx5dGljcy5ldmVudCh7Y2F0ZWdvcnk6ICd1c2VyJywgYWN0aW9uOiAnc2V0LWRvYy10aXRsZSd9KTtcblxuICAgICAgICBsb2cuaW5mbyhcIlNldHRpbmcgZG9jIHRpdGxlOiBcIiAsIHRpdGxlKTtcblxuICAgICAgICB0aGlzLnByb3BzLnJlcG9Eb2NNZXRhTWFuYWdlci53cml0ZURvY0luZm9UaXRsZShyZXBvRG9jSW5mbywgdGl0bGUpXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IGxvZy5lcnJvcihcIkNvdWxkIG5vdCB3cml0ZSBkb2MgdGl0bGU6IFwiLCBlcnIpKTtcblxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgb25TZWxlY3RlZENvbHVtbnMoY29sdW1uczogTGlzdE9wdGlvblR5cGVbXSkge1xuXG4gICAgICAgIFJlbmRlcmVyQW5hbHl0aWNzLmV2ZW50KHtjYXRlZ29yeTogJ3VzZXInLCBhY3Rpb246ICdzZWxlY3RlZC1jb2x1bW5zJ30pO1xuXG4gICAgICAgIC8vIG5ldyBjb2x1bW5zIGhhdmUgYmVlbiBzZWxlY3RlZC4gTm90ZSB0aGF0IHRoZSBVSSB1cGRhdGVzIHRoZSB2YWx1ZXNcbiAgICAgICAgLy8gZGlyZWN0bHkgc28gd2UgY2FuIGp1c3Qgd3JpdGUgd2hhdCdzIGluIG1lbW9yeSB0byBkaXNrLiBJIHRoaW5rIGl0XG4gICAgICAgIC8vIHdvdWxkIGJlIGJldHRlciBwcmFjdGljZSB0byBrZWVwIHRoZW0gaW1tdXRhYmxlLlxuXG4gICAgICAgIFNldHRpbmdzU3RvcmUubG9hZCgpXG4gICAgICAgICAgICAudGhlbigoc2V0dGluZ3NQcm92aWRlcikgPT4ge1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFNldHRpbmdzID0gc2V0dGluZ3NQcm92aWRlcigpO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3M6IFNldHRpbmdzID0ge1xuICAgICAgICAgICAgICAgICAgICAuLi5jdXJyZW50U2V0dGluZ3MsXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50UmVwb3NpdG9yeToge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uczogdGhpcy5zdGF0ZS5jb2x1bW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgU2V0dGluZ3NTdG9yZS53cml0ZShzZXR0aW5ncylcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBsb2cuZXJyb3IoZXJyKSk7XG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IGxvZy5lcnJvcihcIkNvdWxkIG5vdCBsb2FkIHNldHRpbmdzOiBcIiwgZXJyKSk7XG5cbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgfVxuXG5cbiAgICBwcml2YXRlIG9uRmlsdGVyQnlUaXRsZSh0aXRsZTogc3RyaW5nKSB7XG5cbiAgICAgICAgUmVuZGVyZXJBbmFseXRpY3MuZXZlbnQoe2NhdGVnb3J5OiAndXNlcicsIGFjdGlvbjogJ2ZpbHRlci1ieS10aXRsZSd9KTtcbiAgICAgICAgdGhpcy5maWx0ZXJlZFJlcG9Eb2NJbmZvSW5kZXgub25GaWx0ZXJCeVRpdGxlKHRpdGxlKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgcmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5maWx0ZXJlZFJlcG9Eb2NJbmZvSW5kZXgucmVmcmVzaCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gdGhlIGFjdHVhbCByZWZyZXNoLlxuICAgICAqL1xuICAgIHByaXZhdGUgZG9SZWZyZXNoKGRhdGE6IFJlcG9Eb2NJbmZvW10pIHtcblxuICAgICAgICBjb25zdCBzdGF0ZSA9IHsuLi50aGlzLnN0YXRlLCBkYXRhfTtcblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcblxuICAgICAgICAgICAgLy8gVGhlIHJlYWN0IHRhYmxlIHdpbGwgbm90IHVwZGF0ZSB3aGVuIEkgY2hhbmdlIHRoZSBzdGF0ZSBmcm9tXG4gICAgICAgICAgICAvLyB3aXRoaW4gdGhlIGV2ZW50IGxpc3RlbmVyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlKTtcblxuICAgICAgICB9LCAxKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgb25Eb2N1bWVudExvYWRSZXF1ZXN0ZWQoZmluZ2VycHJpbnQ6IHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoY29kZT86IEhhc2hjb2RlKSB7XG5cbiAgICAgICAgaWYgKCEgQXBwUnVudGltZS5pc0VsZWN0cm9uKCkgJiYgZmlsZW5hbWUuZW5kc1dpdGgoXCIucGh6XCIpKSB7XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgQ2FwdHVyZWQgd2ViIHBhZ2VzIChwaHogZmlsZXMpIGFyZSBvbmx5IHN1cHBvcnRlZCBpbiB0aGUgd2ViIHByZXZpZXcgdmVyc2lvbiBvZiBQb2xhciAocGxlYXNlIHVzZSB0aGUgZGVza3RvcCB2ZXJzaW9uKS5gO1xuICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBcIkNhcHR1cmVkIHdlYiBwYWdlcyBub3Qgc3VwcG9ydGVkLlwiO1xuXG4gICAgICAgICAgICBUb2FzdGVyLmVycm9yKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3luY2hyb25pemluZ0RvY0xvYWRlci5sb2FkKGZpbmdlcnByaW50LCBmaWxlbmFtZSwgaGFzaGNvZGUpXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IGxvZy5lcnJvcihcIlVuYWJsZSB0byBsb2FkIGRvYzogXCIsIGVycikpO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkb0hhbmRsZVRvZ2dsZUZpZWxkKHJlcG9Eb2NJbmZvOiBSZXBvRG9jSW5mbywgZmllbGQ6IHN0cmluZykge1xuXG4gICAgICAgIHRoaXMuaGFuZGxlVG9nZ2xlRmllbGQocmVwb0RvY0luZm8sIGZpZWxkKVxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBsb2cuZXJyb3IoYENvdWxkIG5vdCBoYW5kbGUgdG9nZ2xlIG9uIGZpZWxkOiAke2ZpZWxkfTogYCwgZXJyKSk7XG5cbiAgICB9XG5cblxuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlVG9nZ2xlRmllbGQocmVwb0RvY0luZm86IFJlcG9Eb2NJbmZvLCBmaWVsZDogc3RyaW5nKSB7XG5cbiAgICAgICAgLy8gVE9ETzogbW92ZSB0byBzeW5jRG9jSW5mb0FyY2hpdmVkIGluIERvY1JlcG9zaXRvcnlcblxuICAgICAgICBsZXQgbXV0YXRlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChmaWVsZCA9PT0gJ2FyY2hpdmVkJykge1xuICAgICAgICAgICAgUmVuZGVyZXJBbmFseXRpY3MuZXZlbnQoe2NhdGVnb3J5OiAndXNlcicsIGFjdGlvbjogJ2FyY2hpdmVkLWRvYyd9KTtcbiAgICAgICAgICAgIHJlcG9Eb2NJbmZvLmFyY2hpdmVkID0gIXJlcG9Eb2NJbmZvLmFyY2hpdmVkO1xuICAgICAgICAgICAgcmVwb0RvY0luZm8uZG9jSW5mby5hcmNoaXZlZCA9IHJlcG9Eb2NJbmZvLmFyY2hpdmVkO1xuICAgICAgICAgICAgbXV0YXRlZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZmllbGQgPT09ICdmbGFnZ2VkJykge1xuXG4gICAgICAgICAgICBSZW5kZXJlckFuYWx5dGljcy5ldmVudCh7Y2F0ZWdvcnk6ICd1c2VyJywgYWN0aW9uOiAnZmxhZ2dlZC1kb2MnfSk7XG4gICAgICAgICAgICByZXBvRG9jSW5mby5mbGFnZ2VkID0gIXJlcG9Eb2NJbmZvLmZsYWdnZWQ7XG4gICAgICAgICAgICByZXBvRG9jSW5mby5kb2NJbmZvLmZsYWdnZWQgPSByZXBvRG9jSW5mby5mbGFnZ2VkO1xuXG4gICAgICAgICAgICBtdXRhdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtdXRhdGVkKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnByb3BzLnJlcG9Eb2NNZXRhTWFuYWdlciEud3JpdGVEb2NJbmZvKHJlcG9Eb2NJbmZvLmRvY0luZm8pO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIHByaXZhdGUgb25Ub2dnbGVGbGFnZ2VkT25seSh2YWx1ZTogYm9vbGVhbikge1xuICAgICAgICB0aGlzLmZpbHRlcmVkUmVwb0RvY0luZm9JbmRleC5vblRvZ2dsZUZsYWdnZWRPbmx5KHZhbHVlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uVG9nZ2xlRmlsdGVyQXJjaGl2ZWQodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5maWx0ZXJlZFJlcG9Eb2NJbmZvSW5kZXgub25Ub2dnbGVGaWx0ZXJBcmNoaXZlZCh2YWx1ZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbWRJbXBvcnRGcm9tRGlzaygpIHtcblxuICAgICAgICBSZW5kZXJlckFuYWx5dGljcy5ldmVudCh7Y2F0ZWdvcnk6ICdhZGQtY29udGVudCcsIGFjdGlvbjogJ2ltcG9ydC1mcm9tLWRpc2snfSk7XG5cbiAgICAgICAgdGhpcy5nZXRDb250cm9sbGVyKCkuY21kSW1wb3J0KClcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4gbG9nLmVycm9yKFwiQ291bGQgbm90IGltcG9ydCBmcm9tIGRpc2s6IFwiLCBlcnIpKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgY21kQ2FwdHVyZVdlYlBhZ2UoKSB7XG5cbiAgICAgICAgUmVuZGVyZXJBbmFseXRpY3MuZXZlbnQoe2NhdGVnb3J5OiAnYWRkLWNvbnRlbnQnLCBhY3Rpb246ICdjYXB0dXJlLXdlYi1wYWdlJ30pO1xuXG4gICAgICAgIHRoaXMuZ2V0Q29udHJvbGxlcigpLmNtZENhcHR1cmVXZWJQYWdlV2l0aEJyb3dzZXIoKVxuICAgICAgICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiBsb2cuZXJyb3IoXCJDb3VsZCBub3QgY2FwdHVyZSBwYWdlOiBcIiwgZXJyKSk7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGdldENvbnRyb2xsZXIoKTogSU1haW5BcHBDb250cm9sbGVyIHtcbiAgICAgICAgcmV0dXJuIHJlbW90ZS5nZXRHbG9iYWwoJ21haW5BcHBDb250cm9sbGVyJyk7XG4gICAgfVxuXG59XG5cbmludGVyZmFjZSBJUHJvcHMge1xuXG4gICAgcmVhZG9ubHkgcGVyc2lzdGVuY2VMYXllck1hbmFnZXI6IFBlcnNpc3RlbmNlTGF5ZXJNYW5hZ2VyO1xuXG4gICAgcmVhZG9ubHkgdXBkYXRlZERvY0luZm9FdmVudERpc3BhdGNoZXI6IElFdmVudERpc3BhdGNoZXI8SURvY0luZm8+O1xuXG4gICAgcmVhZG9ubHkgcmVwb0RvY01ldGFNYW5hZ2VyOiBSZXBvRG9jTWV0YU1hbmFnZXI7XG5cbiAgICByZWFkb25seSByZXBvRG9jTWV0YUxvYWRlcjogUmVwb0RvY01ldGFMb2FkZXI7XG59XG5cbmludGVyZmFjZSBJU3RhdGUge1xuICAgIHJlYWRvbmx5IGRhdGE6IFJlcG9Eb2NJbmZvW107XG4gICAgcmVhZG9ubHkgY29sdW1uczogRG9jUmVwb1RhYmxlQ29sdW1ucztcbiAgICByZWFkb25seSBzZWxlY3RlZDogUmVhZG9ubHlBcnJheTxudW1iZXI+O1xufVxuXG5pbnRlcmZhY2UgSU1haW5BcHBDb250cm9sbGVyIHtcblxuICAgIGNtZEltcG9ydCgpOiBQcm9taXNlPHZvaWQ+O1xuXG4gICAgY21kQ2FwdHVyZVdlYlBhZ2VXaXRoQnJvd3NlcigpOiBQcm9taXNlPHZvaWQ+O1xufVxuIl19