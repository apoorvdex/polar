"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const chai_1 = require("chai");
const Assertions_1 = require("./test/Assertions");
const utils = require("./utils");
const { computeRangeBuffer } = require("./utils");
const { TextHighlightRows } = require("./highlights/text/controller/TextHighlightRows");
var date = new Date(Date.parse("2018-05-30T02:47:44.411Z"));
describe('Test computeRectForRow for highlighting text...', function () {
    it('Test with 1 entries', function () {
        var rectElements = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            }
        ];
        var expected = { left: 0, top: 4, width: 721, height: 18, right: 721, bottom: 22 };
        chai_1.assert.deepEqual(TextHighlightRows.computeRectForRow(rectElements), expected);
    });
    it('Test with 2 entries', function () {
        var rects = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 800,
                    "bottom": 50
                },
                element: null
            }
        ];
        var expected = { left: 0, top: 4, width: 800, height: 46, right: 800, bottom: 50 };
        chai_1.assert.deepEqual(TextHighlightRows.computeRectForRow(rects), expected);
    });
});
describe('Test computeRows for highlighting text...', function () {
    it('Test with no entries', function () {
        chai_1.assert.deepEqual([], []);
    });
    it('Test with 1 entries', function () {
        var rects = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            }
        ];
        var expected = [
            [{ rect: { left: 0, top: 4, width: 721, height: 18, right: 721, bottom: 22 }, element: null }]
        ];
        chai_1.assert.deepEqual(TextHighlightRows.computeRows(rects), expected);
    });
    it('Test with 2 entries and two rows', function () {
        var rectElements = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 200,
                    "height": 20,
                    "right": 200,
                    "bottom": 24
                },
                element: null
            },
            {
                rect: {
                    "left": 200,
                    "top": 4,
                    "width": 200,
                    "height": 20,
                    "right": 400,
                    "bottom": 24
                },
                element: null
            }
        ];
        var expected = [
            [
                { rect: { left: 0, top: 4, width: 200, height: 20, right: 200, bottom: 24 }, element: null },
                { rect: { left: 200, top: 4, width: 200, height: 20, right: 400, bottom: 24 }, element: null }
            ]
        ];
        chai_1.assert.deepEqual(TextHighlightRows.computeRows(rectElements), expected);
    });
});
describe('Testing for gaps in contiguous rects', function () {
    it('Test with no entries', function () {
        var rects = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 297,
                    "height": 18,
                    "right": 297,
                    "bottom": 22
                },
                element: null
            }
        ];
        chai_1.assert.deepEqual(TextHighlightRows.computeContiguousRects([]), []);
    });
});
describe('Testing computeContiguousRects.', function () {
    it('Test with no entries', function () {
        chai_1.assert.deepEqual(TextHighlightRows.computeContiguousRects([]), []);
    });
    xit('Test with one entry', function () {
        let rects = [
            { rect: { top: 10, left: 10, bottom: 50, right: 50 }, element: null }
        ];
        let expected = [
            {
                "rect": {
                    "left": 10,
                    "top": 10,
                    "right": 50,
                    "bottom": 50,
                    "width": 40,
                    "height": 40
                },
                "rectElements": [
                    {
                        "rect": {
                            "top": 10,
                            "left": 10,
                            "bottom": 50,
                            "right": 50
                        },
                        "element": null
                    }
                ]
            }
        ];
        let actual = TextHighlightRows.computeContiguousRects(rects);
        Assertions_1.assertJSON(actual, expected);
    });
    xit('Test with two entries', function () {
        var boundingClientRects = [
            { rect: { top: 10, left: 10, bottom: 20, right: 50 }, element: null },
            { rect: { top: 50, left: 10, bottom: 70, right: 50 }, element: null }
        ];
        var expected = [
            {
                "rect": {
                    "left": 10,
                    "top": 10,
                    "right": 50,
                    "bottom": 50,
                    "width": 40,
                    "height": 40
                },
                "rectElements": [
                    {
                        "rect": {
                            "top": 10,
                            "left": 10,
                            "bottom": 20,
                            "right": 50
                        },
                        "element": null
                    }
                ]
            },
            {
                "rect": {
                    "left": 10,
                    "top": 50,
                    "right": 50,
                    "bottom": 70,
                    "width": 40,
                    "height": 20
                },
                "rectElements": [
                    {
                        "rect": {
                            "top": 50,
                            "left": 10,
                            "bottom": 70,
                            "right": 50
                        },
                        "element": null
                    }
                ]
            }
        ];
        Assertions_1.assertJSON(TextHighlightRows.computeContiguousRects(boundingClientRects), expected);
    });
});
describe('Testing createSiblingTupples.', function () {
    it('Test with no entries', function () {
        chai_1.assert.deepEqual(utils.createSiblingTuples([]), []);
    });
    it('Test with 1 entry', function () {
        chai_1.assert.deepEqual(utils.createSiblingTuples([1]), [{ curr: 1, prev: null, next: null }]);
    });
    it('Test with 2 entries', function () {
        chai_1.assert.deepEqual(utils.createSiblingTuples([1, 2]), [
            { curr: 1, prev: null, next: 2 },
            { curr: 2, prev: 1, next: null }
        ]);
    });
    it('Test with 3 entries', function () {
        chai_1.assert.deepEqual(utils.createSiblingTuples([1, 2, 3]), [
            { curr: 1, prev: null, next: 2 },
            { curr: 2, prev: 1, next: 3 },
            { curr: 3, prev: 2, next: null }
        ]);
    });
    it('Test with 4 entries', function () {
        chai_1.assert.deepEqual(utils.createSiblingTuples([1, 2, 3, 4]), [
            { curr: 1, prev: null, next: 2 },
            { curr: 2, prev: 1, next: 3 },
            { curr: 3, prev: 2, next: 4 },
            { curr: 4, prev: 3, next: null }
        ]);
    });
});
describe('Testing bounding client rect utils.', function () {
    it('Test with one element', function () {
        var boundingClientRects = [
            { top: 10, left: 10, bottom: 50, right: 50 }
        ];
        var cbr = utils.getBoundingClientRectFromBCRs(boundingClientRects);
        chai_1.assert.deepEqual(cbr, { left: 10, top: 10, bottom: 50, right: 50 });
    });
    it('Test with four elements', function () {
        var boundingClientRects = [
            { top: 10, left: 10, bottom: 50, right: 50 },
            { top: 20, left: 5, bottom: 50, right: 50 },
            { top: 30, left: 10, bottom: 55, right: 50 },
            { top: 40, left: 10, bottom: 50, right: 55 }
        ];
        var cbr = utils.getBoundingClientRectFromBCRs(boundingClientRects);
        chai_1.assert.deepEqual(cbr, { left: 5, top: 10, bottom: 55, right: 55 });
    });
});
describe('Testing Delegates', function () {
    it('Test basic functionality', function () {
        class MyDelegate {
            constructor() {
                this.testArg0 = null;
                this.testArg1 = null;
                this.testArg0 = null;
                this.testArg1 = null;
            }
            testFunction(testArg0, testArg1) {
                this.testArg0 = testArg0;
                this.testArg1 = testArg1;
            }
        }
        var delegate0 = new MyDelegate();
        var delegate1 = new MyDelegate();
        var delegator = new utils.Delegator([delegate0, delegate1]);
        delegator.apply("testFunction", "hello", "world");
        chai_1.assert.equal(delegate0.testArg0, "hello");
        chai_1.assert.equal(delegate0.testArg1, "world");
        chai_1.assert.equal(delegate1.testArg0, "hello");
        chai_1.assert.equal(delegate1.testArg1, "world");
    });
});
describe('Testing progress computation', function () {
});
describe('testing data serialization', function () {
    xit('Test basic serialization ... both ways.', function () {
    });
});
describe('testing model interaction', function () {
    xit('Test computing the range buffers.', function () {
        return __awaiter(this, void 0, void 0, function* () {
            chai_1.assert.deepEqual(computeRangeBuffer(1, 3, 1, 10), { start: 1, end: 4 });
            chai_1.assert.deepEqual(computeRangeBuffer(1, 3, 1, 3), { start: 1, end: 3 });
            chai_1.assert.deepEqual(computeRangeBuffer(3, 3, 1, 10), { start: 1, end: 6 });
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWFpblRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJNYWluVGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBRUEsK0JBQW9DO0FBRXBDLGtEQUE2QztBQUs3QyxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDakMsTUFBTSxFQUFDLGtCQUFrQixFQUFDLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBRWhELE1BQU0sRUFBQyxpQkFBaUIsRUFBQyxHQUFHLE9BQU8sQ0FBQyxnREFBZ0QsQ0FBQyxDQUFDO0FBUXRGLElBQUksSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsMEJBQTBCLENBQUMsQ0FBQyxDQUFDO0FBRTVELFFBQVEsQ0FBQyxpREFBaUQsRUFBRTtJQUV4RCxFQUFFLENBQUMscUJBQXFCLEVBQUU7UUFFdEIsSUFBSSxZQUFZLEdBQUc7WUFDZjtnQkFDSSxJQUFJLEVBQUU7b0JBQ0YsTUFBTSxFQUFFLENBQUM7b0JBQ1QsS0FBSyxFQUFFLENBQUM7b0JBQ1IsT0FBTyxFQUFFLEdBQUc7b0JBQ1osUUFBUSxFQUFFLEVBQUU7b0JBQ1osT0FBTyxFQUFFLEdBQUc7b0JBQ1osUUFBUSxFQUFFLEVBQUU7aUJBQ2Y7Z0JBQ0QsT0FBTyxFQUFFLElBQUk7YUFDaEI7U0FDSixDQUFDO1FBRUYsSUFBSSxRQUFRLEdBQUcsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBRW5GLGFBQU0sQ0FBQyxTQUFTLENBQUMsaUJBQWlCLENBQUMsaUJBQWlCLENBQUMsWUFBWSxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFFbEYsQ0FBQyxDQUFDLENBQUM7SUFFSCxF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QUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ3hFLGFBQU0sQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZFLGFBQU0sQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBRTVFLENBQUM7S0FBQSxDQUFDLENBQUM7QUFHUCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGFsbCBvdXIgdW5pdCB0ZXN0cy4uLlxuXG5pbXBvcnQge2Fzc2VydCwgZXhwZWN0fSBmcm9tICdjaGFpJztcbmltcG9ydCBjaGFpIGZyb20gJ2NoYWknO1xuaW1wb3J0IHthc3NlcnRKU09OfSBmcm9tICcuL3Rlc3QvQXNzZXJ0aW9ucyc7XG5pbXBvcnQge0RvY01ldGFzfSBmcm9tICcuL21ldGFkYXRhL0RvY01ldGFzJztcbmltcG9ydCB7RG9jTWV0YX0gZnJvbSAnLi9tZXRhZGF0YS9Eb2NNZXRhJztcbi8vIGltcG9ydCBjaGFpRGlmZiBmcm9tICdjaGFpLWRpZmYnO1xuXG5jb25zdCB1dGlscyA9IHJlcXVpcmUoXCIuL3V0aWxzXCIpO1xuY29uc3Qge2NvbXB1dGVSYW5nZUJ1ZmZlcn0gPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcblxuY29uc3Qge1RleHRIaWdobGlnaHRSb3dzfSA9IHJlcXVpcmUoXCIuL2hpZ2hsaWdodHMvdGV4dC9jb250cm9sbGVyL1RleHRIaWdobGlnaHRSb3dzXCIpO1xuXG4vL2ltcG9ydCAqIGFzIHV0aWxzIGZyb20gXCIuL3V0aWxzLmpzXCI7XG5cbi8vY2hhaS5jb25maWcudHJ1bmNhdGVUaHJlc2hvbGQgPSAwO1xuLy9jaGFpLnVzZShjaGFpRGlmZik7XG5cbi8vIHN0YWJsZSByZWZlcmVuY2UgZGF0ZSBmb3IgYWxsIHRlc3RzLlxudmFyIGRhdGUgPSBuZXcgRGF0ZShEYXRlLnBhcnNlKFwiMjAxOC0wNS0zMFQwMjo0Nzo0NC40MTFaXCIpKTtcblxuZGVzY3JpYmUoJ1Rlc3QgY29tcHV0ZVJlY3RGb3JSb3cgZm9yIGhpZ2hsaWdodGluZyB0ZXh0Li4uJywgZnVuY3Rpb24oKSB7XG5cbiAgICBpdCgnVGVzdCB3aXRoIDEgZW50cmllcycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgcmVjdEVsZW1lbnRzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgdmFyIGV4cGVjdGVkID0geyBsZWZ0OiAwLCB0b3A6IDQsIHdpZHRoOiA3MjEsIGhlaWdodDogMTgsIHJpZ2h0OiA3MjEsIGJvdHRvbTogMjIgfTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKFRleHRIaWdobGlnaHRSb3dzLmNvbXB1dGVSZWN0Rm9yUm93KHJlY3RFbGVtZW50cyksIGV4cGVjdGVkKTtcblxuICAgIH0pO1xuXG4gICAgaXQoJ1Rlc3Qgd2l0aCAyIGVudHJpZXMnLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHJlY3RzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA4MDAsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDUwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgXTtcblxuICAgICAgICB2YXIgZXhwZWN0ZWQgPSB7IGxlZnQ6IDAsIHRvcDogNCwgd2lkdGg6IDgwMCwgaGVpZ2h0OiA0NiwgcmlnaHQ6IDgwMCwgYm90dG9tOiA1MCB9O1xuXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoVGV4dEhpZ2hsaWdodFJvd3MuY29tcHV0ZVJlY3RGb3JSb3cocmVjdHMpLCBleHBlY3RlZCk7XG5cbiAgICB9KTtcblxufSk7XG5cbmRlc2NyaWJlKCdUZXN0IGNvbXB1dGVSb3dzIGZvciBoaWdobGlnaHRpbmcgdGV4dC4uLicsIGZ1bmN0aW9uKCkge1xuXG4gICAgaXQoJ1Rlc3Qgd2l0aCBubyBlbnRyaWVzJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoW10sIFtdKTtcblxuXG4gICAgfSk7XG5cbiAgICBpdCgnVGVzdCB3aXRoIDEgZW50cmllcycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgcmVjdHMgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogNCxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDE4LFxuICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDcyMSxcbiAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIjogMjJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcblxuICAgICAgICB2YXIgZXhwZWN0ZWQgPSBbXG4gICAgICAgICAgICBbIHsgcmVjdDoge2xlZnQ6IDAsIHRvcDogNCwgd2lkdGg6IDcyMSwgaGVpZ2h0OiAxOCwgcmlnaHQ6IDcyMSwgYm90dG9tOiAyMiB9LCBlbGVtZW50OiBudWxsfSBdXG4gICAgICAgIF07XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChUZXh0SGlnaGxpZ2h0Um93cy5jb21wdXRlUm93cyhyZWN0cyksIGV4cGVjdGVkKTtcblxuXG4gICAgfSk7XG5cbiAgICBpdCgnVGVzdCB3aXRoIDIgZW50cmllcyBhbmQgdHdvIHJvd3MnLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHJlY3RFbGVtZW50cyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAwLFxuICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiA0LFxuICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDIwMCxcbiAgICAgICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMjAsXG4gICAgICAgICAgICAgICAgICAgIFwicmlnaHRcIjogMjAwLFxuICAgICAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiAyNFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZWxlbWVudDogbnVsbFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAyMDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogMjAwLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAyMCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA0MDAsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDI0XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgdmFyIGV4cGVjdGVkID0gW1xuICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgIHsgcmVjdDogeyBsZWZ0OiAwLCB0b3A6IDQsIHdpZHRoOiAyMDAsIGhlaWdodDogMjAsIHJpZ2h0OiAyMDAsIGJvdHRvbTogMjR9LCBlbGVtZW50OiBudWxsIH0sXG4gICAgICAgICAgICAgICAgeyByZWN0OiB7IGxlZnQ6IDIwMCwgdG9wOiA0LCB3aWR0aDogMjAwLCBoZWlnaHQ6IDIwLCByaWdodDogNDAwLCBib3R0b206IDI0fSwgZWxlbWVudDogbnVsbCB9XG4gICAgICAgICAgICBdXG4gICAgICAgIF07XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChUZXh0SGlnaGxpZ2h0Um93cy5jb21wdXRlUm93cyhyZWN0RWxlbWVudHMpLCBleHBlY3RlZCk7XG5cbiAgICB9KTtcblxuXG5cbn0pXG5cblxuZGVzY3JpYmUoJ1Rlc3RpbmcgZm9yIGdhcHMgaW4gY29udGlndW91cyByZWN0cycsIGZ1bmN0aW9uKCkge1xuXG4gICAgaXQoJ1Rlc3Qgd2l0aCBubyBlbnRyaWVzJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vIEZJWE1FOiBicmVhayB0aGlzIG91dCBpbnRvIGEgcmVhbCB0ZXN0Li4uXG5cbiAgICAgICAgdmFyIHJlY3RzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogNCxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAyOTcsXG4gICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDE4LFxuICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDI5NyxcbiAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIjogMjJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKFRleHRIaWdobGlnaHRSb3dzLmNvbXB1dGVDb250aWd1b3VzUmVjdHMoW10pLCBbXSk7XG5cbiAgICB9KTtcblxufSlcblxuZGVzY3JpYmUoJ1Rlc3RpbmcgY29tcHV0ZUNvbnRpZ3VvdXNSZWN0cy4nLCBmdW5jdGlvbigpIHtcblxuICAgIGl0KCdUZXN0IHdpdGggbm8gZW50cmllcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChUZXh0SGlnaGxpZ2h0Um93cy5jb21wdXRlQ29udGlndW91c1JlY3RzKFtdKSwgW10pO1xuICAgIH0pO1xuXG4gICAgeGl0KCdUZXN0IHdpdGggb25lIGVudHJ5JywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGxldCByZWN0cyA9IFtcbiAgICAgICAgICAgIHsgcmVjdDoge3RvcDogMTAsIGxlZnQ6IDEwLCBib3R0b206IDUwLCByaWdodDogNTB9LCBlbGVtZW50OiBudWxsIH1cbiAgICAgICAgXTtcblxuICAgICAgICBsZXQgZXhwZWN0ZWQgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgXCJyZWN0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDEwLFxuICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIjogNTAsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNDAsXG4gICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDQwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInJlY3RFbGVtZW50c1wiOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicmlnaHRcIjogNTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVsZW1lbnRcIjogbnVsbFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuXG4gICAgICAgIGxldCBhY3R1YWwgPSBUZXh0SGlnaGxpZ2h0Um93cy5jb21wdXRlQ29udGlndW91c1JlY3RzKHJlY3RzKTtcblxuICAgICAgICBhc3NlcnRKU09OKGFjdHVhbCwgZXhwZWN0ZWQpO1xuXG4gICAgfSk7XG5cbiAgICB4aXQoJ1Rlc3Qgd2l0aCB0d28gZW50cmllcycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgYm91bmRpbmdDbGllbnRSZWN0cyA9IFtcbiAgICAgICAgICAgIHtyZWN0OiB7dG9wOiAxMCwgbGVmdDogMTAsIGJvdHRvbTogMjAsIHJpZ2h0OiA1MH0sIGVsZW1lbnQ6IG51bGwgfSxcbiAgICAgICAgICAgIHtyZWN0OiB7dG9wOiA1MCwgbGVmdDogMTAsIGJvdHRvbTogNzAsIHJpZ2h0OiA1MH0sIGVsZW1lbnQ6IG51bGwgfVxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBleHBlY3RlZCA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcInJlY3RcIjoge1xuICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogMTAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDEwLFxuICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDUwLFxuICAgICAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiA0MCxcbiAgICAgICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogNDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwicmVjdEVsZW1lbnRzXCI6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWN0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIjogMjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA1MFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZWxlbWVudFwiOiBudWxsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFwicmVjdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogNTAsXG4gICAgICAgICAgICAgICAgICAgIFwicmlnaHRcIjogNTAsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDcwLFxuICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDQwLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAyMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJyZWN0RWxlbWVudHNcIjogW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlY3RcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiA3MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDUwXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbGVtZW50XCI6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcblxuICAgICAgICBhc3NlcnRKU09OKFRleHRIaWdobGlnaHRSb3dzLmNvbXB1dGVDb250aWd1b3VzUmVjdHMoYm91bmRpbmdDbGllbnRSZWN0cyksIGV4cGVjdGVkKTtcblxuICAgIH0pO1xuXG59KTtcblxuZGVzY3JpYmUoJ1Rlc3RpbmcgY3JlYXRlU2libGluZ1R1cHBsZXMuJywgZnVuY3Rpb24oKSB7XG5cbiAgICBpdCgnVGVzdCB3aXRoIG5vIGVudHJpZXMnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKCB1dGlscy5jcmVhdGVTaWJsaW5nVHVwbGVzKFtdKSwgW10pO1xuXG4gICAgfSk7XG5cbiAgICBpdCgnVGVzdCB3aXRoIDEgZW50cnknLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKCB1dGlscy5jcmVhdGVTaWJsaW5nVHVwbGVzKFsxXSksIFsgeyBjdXJyOiAxLCBwcmV2OiBudWxsLCBuZXh0OiBudWxsIH0gXSk7XG5cbiAgICB9KTtcblxuICAgIGl0KCdUZXN0IHdpdGggMiBlbnRyaWVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbCggdXRpbHMuY3JlYXRlU2libGluZ1R1cGxlcyhbMSwyXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY3VycjogMSwgcHJldjogbnVsbCwgbmV4dDogMiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjdXJyOiAyLCBwcmV2OiAxLCBuZXh0OiBudWxsIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG5cbiAgICB9KTtcblxuICAgIGl0KCdUZXN0IHdpdGggMyBlbnRyaWVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbCggdXRpbHMuY3JlYXRlU2libGluZ1R1cGxlcyhbMSwyLDNdKSxcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICB7IGN1cnI6IDEsIHByZXY6IG51bGwsIG5leHQ6IDIgfSxcbiAgICAgICAgICAgICAgICB7IGN1cnI6IDIsIHByZXY6IDEsIG5leHQ6IDMgfSxcbiAgICAgICAgICAgICAgICB7IGN1cnI6IDMsIHByZXY6IDIsIG5leHQ6IG51bGwgfVxuICAgICAgICAgICAgXSk7XG5cbiAgICB9KTtcblxuICAgIGl0KCdUZXN0IHdpdGggNCBlbnRyaWVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbCggdXRpbHMuY3JlYXRlU2libGluZ1R1cGxlcyhbMSwyLDMsNF0pLFxuICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgIHsgY3VycjogMSwgcHJldjogbnVsbCwgbmV4dDogMiB9LFxuICAgICAgICAgICAgICAgIHsgY3VycjogMiwgcHJldjogMSwgbmV4dDogMyB9LFxuICAgICAgICAgICAgICAgIHsgY3VycjogMywgcHJldjogMiwgbmV4dDogNCB9LFxuICAgICAgICAgICAgICAgIHsgY3VycjogNCwgcHJldjogMywgbmV4dDogbnVsbCB9XG4gICAgICAgICAgICBdKTtcblxuICAgIH0pO1xuXG5cbn0pO1xuXG5kZXNjcmliZSgnVGVzdGluZyBib3VuZGluZyBjbGllbnQgcmVjdCB1dGlscy4nLCBmdW5jdGlvbigpIHtcblxuICAgIGl0KCdUZXN0IHdpdGggb25lIGVsZW1lbnQnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICB2YXIgYm91bmRpbmdDbGllbnRSZWN0cyA9IFtcbiAgICAgICAgICAgIHt0b3A6IDEwLCBsZWZ0OiAxMCwgYm90dG9tOiA1MCwgcmlnaHQ6IDUwfVxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBjYnIgPSB1dGlscy5nZXRCb3VuZGluZ0NsaWVudFJlY3RGcm9tQkNScyhib3VuZGluZ0NsaWVudFJlY3RzKTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGNiciwgeyBsZWZ0OiAxMCwgdG9wOiAxMCwgYm90dG9tOiA1MCwgcmlnaHQ6IDUwIH0pO1xuXG4gICAgfSk7XG5cbiAgICBpdCgnVGVzdCB3aXRoIGZvdXIgZWxlbWVudHMnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICB2YXIgYm91bmRpbmdDbGllbnRSZWN0cyA9IFtcbiAgICAgICAgICAgIHt0b3A6IDEwLCBsZWZ0OiAxMCwgYm90dG9tOiA1MCwgcmlnaHQ6IDUwfSxcbiAgICAgICAgICAgIHt0b3A6IDIwLCBsZWZ0OiA1LCAgYm90dG9tOiA1MCwgcmlnaHQ6IDUwfSxcbiAgICAgICAgICAgIHt0b3A6IDMwLCBsZWZ0OiAxMCwgYm90dG9tOiA1NSwgcmlnaHQ6IDUwfSxcbiAgICAgICAgICAgIHt0b3A6IDQwLCBsZWZ0OiAxMCwgYm90dG9tOiA1MCwgcmlnaHQ6IDU1fVxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBjYnIgPSB1dGlscy5nZXRCb3VuZGluZ0NsaWVudFJlY3RGcm9tQkNScyhib3VuZGluZ0NsaWVudFJlY3RzKTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGNiciwgeyBsZWZ0OiA1LCB0b3A6IDEwLCBib3R0b206IDU1LCByaWdodDogNTUgfSk7XG5cbiAgICB9KTtcblxufSk7XG5cblxuZGVzY3JpYmUoJ1Rlc3RpbmcgRGVsZWdhdGVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICBpdCgnVGVzdCBiYXNpYyBmdW5jdGlvbmFsaXR5JywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY2xhc3MgTXlEZWxlZ2F0ZSB7XG5cbiAgICAgICAgICAgIHRlc3RBcmcwOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgICAgICAgICAgIHRlc3RBcmcxOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRlc3RBcmcwID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnRlc3RBcmcxID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGVzdEZ1bmN0aW9uKHRlc3RBcmcwOiBzdHJpbmcsIHRlc3RBcmcxOiBzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRlc3RBcmcwID0gdGVzdEFyZzA7XG4gICAgICAgICAgICAgICAgdGhpcy50ZXN0QXJnMSA9IHRlc3RBcmcxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZGVsZWdhdGUwID0gbmV3IE15RGVsZWdhdGUoKTtcbiAgICAgICAgdmFyIGRlbGVnYXRlMSA9IG5ldyBNeURlbGVnYXRlKCk7XG5cbiAgICAgICAgdmFyIGRlbGVnYXRvciA9IG5ldyB1dGlscy5EZWxlZ2F0b3IoW2RlbGVnYXRlMCwgZGVsZWdhdGUxXSk7XG5cbiAgICAgICAgZGVsZWdhdG9yLmFwcGx5KFwidGVzdEZ1bmN0aW9uXCIsIFwiaGVsbG9cIiwgXCJ3b3JsZFwiKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoZGVsZWdhdGUwLnRlc3RBcmcwLCBcImhlbGxvXCIpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoZGVsZWdhdGUwLnRlc3RBcmcxLCBcIndvcmxkXCIpO1xuXG4gICAgICAgIGFzc2VydC5lcXVhbChkZWxlZ2F0ZTEudGVzdEFyZzAsIFwiaGVsbG9cIik7XG4gICAgICAgIGFzc2VydC5lcXVhbChkZWxlZ2F0ZTEudGVzdEFyZzEsIFwid29ybGRcIik7XG5cbiAgICB9KTtcblxufSk7XG5cbmRlc2NyaWJlKCdUZXN0aW5nIHByb2dyZXNzIGNvbXB1dGF0aW9uJywgZnVuY3Rpb24oKSB7XG5cbiAgICAvLyB4aXQoJ0NvbXB1dGUgYmFzaWMgcHJvZ3Jlc3MnLCBmdW5jdGlvbigpIHtcbiAgICAvL1xuICAgIC8vICAgICBsZXQgZG9jTWV0YSA9IERvY01ldGFzLmNyZWF0ZVdpdGhpbkluaXRpYWxQYWdlbWFya3MoXCIweDAwMDBcIiwgMTApO1xuICAgIC8vXG4gICAgLy8gICAgIGxldCB3ZWJWaWV3ID0gbmV3IFdlYlZpZXcoKTtcbiAgICAvLyAgICAgbGV0IHByb2dyZXNzID0gd2ViVmlldy5jb21wdXRlUHJvZ3Jlc3MoZG9jTWV0YSk7XG4gICAgLy9cbiAgICAvLyAgICAgYXNzZXJ0LmVxdWFsKHByb2dyZXNzLCAwLjMpO1xuICAgIC8vXG4gICAgLy8gfSk7XG4gICAgLy9cbiAgICAvLyB4aXQoJ0NvbXB1dGUgYmFzaWMgcHJvZ3Jlc3MgYXQgMTAwIHBlcmNlbnQnLCBmdW5jdGlvbigpIHtcbiAgICAvL1xuICAgIC8vICAgICBsZXQgZG9jTWV0YSA9IERvY01ldGFzLmNyZWF0ZVdpdGhpbkluaXRpYWxQYWdlbWFya3MoXCIweDAwMDBcIiwgMyk7XG4gICAgLy9cbiAgICAvLyAgICAgbGV0IHdlYlZpZXcgPSBuZXcgV2ViVmlldygpO1xuICAgIC8vICAgICBsZXQgcHJvZ3Jlc3MgPSB3ZWJWaWV3LmNvbXB1dGVQcm9ncmVzcyhkb2NNZXRhKTtcbiAgICAvL1xuICAgIC8vICAgICBhc3NlcnQuZXF1YWwocHJvZ3Jlc3MsIDEuMCk7XG4gICAgLy9cbiAgICAvLyB9KTtcblxufSk7XG5cbmRlc2NyaWJlKCd0ZXN0aW5nIGRhdGEgc2VyaWFsaXphdGlvbicsIGZ1bmN0aW9uKCkge1xuXG4gICAgeGl0KCdUZXN0IGJhc2ljIHNlcmlhbGl6YXRpb24gLi4uIGJvdGggd2F5cy4nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gbGV0IGZpbmdlcnByaW50ID0gXCIweGRlY2FmYmFkXCI7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIGxldCBkb2NNZXRhID0gRG9jTWV0YXMuY3JlYXRlKGZpbmdlcnByaW50LCAyKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gbGV0IHNlcmlhbGl6ZWQgPSBNZXRhZGF0YVNlcmlhbGl6ZXIuc2VyaWFsaXplKGRvY01ldGEsIFwiICBcIik7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIGFzc2VydEpTT04oc2VyaWFsaXplZCwgXCJ7XFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICBcXFwiZG9jSW5mb1xcXCI6IHtcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgXFxcInRpdGxlXFxcIjogbnVsbCxcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgXFxcInVybFxcXCI6IG51bGwsXFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgIFxcXCJuclBhZ2VzXFxcIjogMixcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgXFxcImZpbmdlcnByaW50XFxcIjogXFxcIjB4ZGVjYWZiYWRcXFwiXFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICB9LFxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgXFxcInBhZ2VNZXRhc1xcXCI6IHtcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgXFxcIjFcXFwiOiB7XFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgICAgXFxcInBhZ2VJbmZvXFxcIjoge1xcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICAgICAgXFxcIm51bVxcXCI6IDFcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgICB9LFxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICAgIFxcXCJwYWdlbWFya3NcXFwiOiB7fVxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICB9LFxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICBcXFwiMlxcXCI6IHtcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgICBcXFwicGFnZUluZm9cXFwiOiB7XFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgICAgICBcXFwibnVtXFxcIjogMlxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICAgIH0sXFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgICAgXFxcInBhZ2VtYXJrc1xcXCI6IHt9XFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgIH1cXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgIH0sXFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICBcXFwidmVyc2lvblxcXCI6IDFcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCJ9XCIpO1xuICAgICAgICAvL1xuICAgICAgICAvLyBsZXQgZG9jTWV0YURlc2VyaWFsaXplZCA9IE1ldGFkYXRhU2VyaWFsaXplci5kZXNlcmlhbGl6ZShuZXcgRG9jTWV0YSgpLCBzZXJpYWxpemVkKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gZXhwZWN0KGRvY01ldGFEZXNlcmlhbGl6ZWQpLnRvLmRlZXAuZXF1YWwoZG9jTWV0YSk7XG5cblxuICAgIH0pO1xuXG59KTtcblxuZGVzY3JpYmUoJ3Rlc3RpbmcgbW9kZWwgaW50ZXJhY3Rpb24nLCBmdW5jdGlvbigpIHtcblxuXG4gICAgLy8gaXQoJ1Rlc3QgY29tcHV0ZSBpbml0aWFsIC4nLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICAvL1xuICAgIC8vICAgICB2YXIgY2xvY2sgPSBuZXcgU3ludGhldGljQ2xvY2soKTtcbiAgICAvLyAgICAgdmFyIGRhdGFzdG9yZSA9IG5ldyBNZW1vcnlEYXRhc3RvcmUoKTtcbiAgICAvLyAgICAgdmFyIG1vZGVsID0gbmV3IE1vZGVsKGRhdGFzdG9yZSwgY2xvY2spO1xuICAgIC8vICAgICB2YXIgdmlldyA9IG5ldyBNb2NrVmlldyhtb2RlbCk7XG4gICAgLy9cbiAgICAvLyAgICAgbGV0IGZpbmdlcnByaW50ID0gXCJmYWtlLWZpbmdlcnByaW50XCI7XG4gICAgLy9cbiAgICAvLyAgICAgdmFyIGRvY01ldGEgPSBhd2FpdCBtb2RlbC5kb2N1bWVudExvYWRlZChmaW5nZXJwcmludCwgMSk7XG4gICAgLy9cbiAgICAvLyAgICAgYXNzZXJ0LmVxdWFsKG1vZGVsLmNvbXB1dGVJbml0aWFsUGFnZW1hcmtQYWdlTnVtYmVycyhkb2NNZXRhLCAxKSxcbiAgICAvLyBbXSk7ICB9KTtcblxuICAgIHhpdCgnVGVzdCBjb21wdXRpbmcgdGhlIHJhbmdlIGJ1ZmZlcnMuJywgYXN5bmMgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChjb21wdXRlUmFuZ2VCdWZmZXIoMSwgMywgMSwgMTApLCB7IHN0YXJ0OiAxLCBlbmQ6IDQgfSk7XG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoY29tcHV0ZVJhbmdlQnVmZmVyKDEsIDMsIDEsIDMpLCB7IHN0YXJ0OiAxLCBlbmQ6IDMgfSk7XG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoY29tcHV0ZVJhbmdlQnVmZmVyKDMsIDMsIDEsIDEwKSwgeyBzdGFydDogMSwgZW5kOiA2IH0pO1xuXG4gICAgfSk7XG5cblxufSk7XG5cbi8vIGFzc2VydC5kZWVwSlNPTiA9IGZ1bmN0aW9uKGFjdHVhbCxleHBlY3RlZCkge1xuLy9cbi8vICAgICAvLyBmaXJzdCBjb252ZXJ0IGJvdGggdG8gSlNPTiBpZiBuZWNlc3NhcnkuXG4vLyAgICAgYWN0dWFsID0gdG9KU09OKGFjdHVhbCk7XG4vLyAgICAgZXhwZWN0ZWQgPSB0b0pTT04oZXhwZWN0ZWQpO1xuLy9cbi8vICAgICBpZiAoIGFjdHVhbCAhPT0gZXhwZWN0ZWQpIHtcbi8vICAgICAgICAgY29uc29sZS5lcnJvcihcIlRoZSBmb2xsb3dpbmcgY29udGVudCB3YXMgbm90IGV4cGVjdGVkOiBcIik7XG4vLyAgICAgICAgIGNvbnNvbGUuZXJyb3IoYWN0dWFsKTtcbi8vICAgICB9XG4vL1xuLy8gICAgIC8vYXNzZXJ0LmVxdWFsKGFjdHVhbCxleHBlY3RlZCk7XG4vL1xuLy8gICAgIGV4cGVjdChleHBlY3RlZCkubm90LmRpZmZlcmVudEZyb20oYWN0dWFsKTtcbi8vXG4vLyB9XG4vL1xuLy8gZnVuY3Rpb24gdG9KU09OKG9iaikge1xuLy9cbi8vICAgICBpZih0eXBlb2Ygb2JqID09PSBcInN0cmluZ1wiKSB7XG4vLyAgICAgICAgIHJldHVybiBvYmo7XG4vLyAgICAgfVxuLy9cbi8vICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqLCBudWxsLCBcIiAgXCIpO1xuLy9cbi8vIH1cbiJdfQ==