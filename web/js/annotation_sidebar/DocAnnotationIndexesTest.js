"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const AnnotationType_1 = require("../metadata/AnnotationType");
const Arrays_1 = require("../util/Arrays");
const DocAnnotationIndexes_1 = require("./DocAnnotationIndexes");
const DocAnnotationIndex_1 = require("./DocAnnotationIndex");
const Assertions_1 = require("../test/Assertions");
const TextHighlights_1 = require("../metadata/TextHighlights");
describe('DocAnnotationIndexes', function () {
    it("Basic sorting", function () {
        const a0 = createAnnotation('0001', 1, 0, 0);
        const a1 = createAnnotation('0002', 1, 0, 0);
        const a2 = createAnnotation('0003', 1, 0, 0);
        const docAnnotationMap = createDocAnnotationMap(a0, a1);
        const docAnnotationIndex = new DocAnnotationIndex_1.DocAnnotationIndex(docAnnotationMap, Object.values(docAnnotationMap));
        const rebuiltDocAnnotationIndex = DocAnnotationIndexes_1.DocAnnotationIndexes.rebuild(docAnnotationIndex, a2);
        const expected = [
            {
                "id": "0001",
                "annotationType": "TEXT_HIGHLIGHT",
                "pageNum": 1,
                "position": {
                    "x": 0,
                    "y": 0
                },
                "created": "2009-06-15T13:45:30",
                "pageMeta": null,
                "children": [],
                "comments": []
            },
            {
                "id": "0002",
                "annotationType": "TEXT_HIGHLIGHT",
                "pageNum": 1,
                "position": {
                    "x": 0,
                    "y": 0
                },
                "created": "2009-06-15T13:45:30",
                "pageMeta": null,
                "children": [],
                "comments": []
            },
            {
                "id": "0003",
                "annotationType": "TEXT_HIGHLIGHT",
                "pageNum": 1,
                "position": {
                    "x": 0,
                    "y": 0
                },
                "created": "2009-06-15T13:45:30",
                "pageMeta": null,
                "children": [],
                "comments": []
            }
        ];
        const result = Arrays_1.Arrays.first(rebuiltDocAnnotationIndex.sortedDocAnnotation);
        Assertions_1.assertJSON(result, expected);
    });
    it("complex sorting", function () {
        const a0 = createAnnotation('0001', 3, 0, 100);
        const a1 = createAnnotation('0002', 2, 100, 0);
        const a2 = createAnnotation('0003', 1, 25, 50);
        const docAnnotationMap = createDocAnnotationMap(a0, a1);
        const docAnnotationIndex = new DocAnnotationIndex_1.DocAnnotationIndex(docAnnotationMap, Object.values(docAnnotationMap));
        const rebuiltDocAnnotationIndex = DocAnnotationIndexes_1.DocAnnotationIndexes.rebuild(docAnnotationIndex, a2);
        const expected = [
            {
                "id": "0003",
                "annotationType": "TEXT_HIGHLIGHT",
                "pageNum": 1,
                "position": {
                    "x": 25,
                    "y": 50
                },
                "created": "2009-06-15T13:45:30",
                "pageMeta": null,
                "children": [],
                "comments": []
            },
            {
                "id": "0002",
                "annotationType": "TEXT_HIGHLIGHT",
                "pageNum": 2,
                "position": {
                    "x": 100,
                    "y": 0
                },
                "created": "2009-06-15T13:45:30",
                "pageMeta": null,
                "children": [],
                "comments": []
            },
            {
                "id": "0001",
                "annotationType": "TEXT_HIGHLIGHT",
                "pageNum": 3,
                "position": {
                    "x": 0,
                    "y": 100
                },
                "created": "2009-06-15T13:45:30",
                "pageMeta": null,
                "children": [],
                "comments": []
            }
        ];
        Assertions_1.assertJSON(rebuiltDocAnnotationIndex.sortedDocAnnotation, expected);
    });
});
function createAnnotation(id, pageNum, x, y) {
    const textHighlight = TextHighlights_1.TextHighlights.createMockTextHighlight();
    return {
        id,
        annotationType: AnnotationType_1.AnnotationType.TEXT_HIGHLIGHT,
        pageNum,
        position: {
            x,
            y
        },
        created: '2009-06-15T13:45:30',
        pageMeta: null,
        children: [],
        comments: [],
        original: textHighlight
    };
}
function createDocAnnotationMap(...docAnnotations) {
    const result = {};
    docAnnotations = Arrays_1.Arrays.shuffle(...docAnnotations);
    for (const docAnnotation of docAnnotations) {
        result[docAnnotation.id] = docAnnotation;
    }
    return result;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRG9jQW5ub3RhdGlvbkluZGV4ZXNUZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiRG9jQW5ub3RhdGlvbkluZGV4ZXNUZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsK0RBQTBEO0FBQzFELDJDQUFzQztBQUN0QyxpRUFBNEQ7QUFDNUQsNkRBQXdEO0FBQ3hELG1EQUE4QztBQUM5QywrREFBMEQ7QUFFMUQsUUFBUSxDQUFDLHNCQUFzQixFQUFFO0lBRTdCLEVBQUUsQ0FBQyxlQUFlLEVBQUU7UUFFaEIsTUFBTSxFQUFFLEdBQWtCLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBRSxDQUFDO1FBQzdELE1BQU0sRUFBRSxHQUFrQixnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUUsQ0FBQztRQUM3RCxNQUFNLEVBQUUsR0FBa0IsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFFLENBQUM7UUFFN0QsTUFBTSxnQkFBZ0IsR0FBRyxzQkFBc0IsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFeEQsTUFBTSxrQkFBa0IsR0FBRyxJQUFJLHVDQUFrQixDQUFDLGdCQUFnQixFQUNoQixNQUFNLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQztRQUVuRixNQUFNLHlCQUF5QixHQUFHLDJDQUFvQixDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUV2RixNQUFNLFFBQVEsR0FBUTtZQUNsQjtnQkFDSSxJQUFJLEVBQUUsTUFBTTtnQkFDWixnQkFBZ0IsRUFBRSxnQkFBZ0I7Z0JBQ2xDLFNBQVMsRUFBRSxDQUFDO2dCQUNaLFVBQVUsRUFBRTtvQkFDUixHQUFHLEVBQUUsQ0FBQztvQkFDTixHQUFHLEVBQUUsQ0FBQztpQkFDVDtnQkFDRCxTQUFTLEVB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Q0QsU0FBUyxFQUFFLHFCQUFxQjtnQkFDaEMsVUFBVSxFQUFFLElBQUk7Z0JBQ2hCLFVBQVUsRUFBRSxFQUFFO2dCQUNkLFVBQVUsRUFBRSxFQUFFO2FBQ2pCO1NBQ0osQ0FBQztRQUVGLHVCQUFVLENBQUMseUJBQXlCLENBQUMsbUJBQW1CLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFFeEUsQ0FBQyxDQUFDLENBQUM7QUFHUCxDQUFDLENBQUMsQ0FBQztBQUVILFNBQVMsZ0JBQWdCLENBQUMsRUFBVSxFQUNWLE9BQWUsRUFDZixDQUFTLEVBQ1QsQ0FBUztJQUUvQixNQUFNLGFBQWEsR0FBRywrQkFBYyxDQUFDLHVCQUF1QixFQUFFLENBQUM7SUFFL0QsT0FBTztRQUNILEVBQUU7UUFDRixjQUFjLEVBQUUsK0JBQWMsQ0FBQyxjQUFjO1FBQzdDLE9BQU87UUFDUCxRQUFRLEVBQUU7WUFDTixDQUFDO1lBQ0QsQ0FBQztTQUNKO1FBQ0QsT0FBTyxFQUFFLHFCQUFxQjtRQUM5QixRQUFRLEVBQUUsSUFBSztRQUNmLFFBQVEsRUFBRSxFQUFFO1FBQ1osUUFBUSxFQUFFLEVBQUU7UUFDWixRQUFRLEVBQUUsYUFBYTtLQUMxQixDQUFDO0FBRU4sQ0FBQztBQUVELFNBQVMsc0JBQXNCLENBQUMsR0FBRyxjQUErQjtJQUU5RCxNQUFNLE1BQU0sR0FBcUIsRUFBRSxDQUFDO0lBRXBDLGNBQWMsR0FBRyxlQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsY0FBYyxDQUFDLENBQUM7SUFFbkQsS0FBSyxNQUFNLGFBQWEsSUFBSSxjQUFjLEVBQUU7UUFDeEMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsR0FBRyxhQUFhLENBQUM7S0FDNUM7SUFFRCxPQUFPLE1BQU0sQ0FBQztBQUVsQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEb2NBbm5vdGF0aW9uLCBEb2NBbm5vdGF0aW9uTWFwfSBmcm9tICcuL0RvY0Fubm90YXRpb24nO1xuaW1wb3J0IHtBbm5vdGF0aW9uVHlwZX0gZnJvbSAnLi4vbWV0YWRhdGEvQW5ub3RhdGlvblR5cGUnO1xuaW1wb3J0IHtBcnJheXN9IGZyb20gJy4uL3V0aWwvQXJyYXlzJztcbmltcG9ydCB7RG9jQW5ub3RhdGlvbkluZGV4ZXN9IGZyb20gJy4vRG9jQW5ub3RhdGlvbkluZGV4ZXMnO1xuaW1wb3J0IHtEb2NBbm5vdGF0aW9uSW5kZXh9IGZyb20gJy4vRG9jQW5ub3RhdGlvbkluZGV4JztcbmltcG9ydCB7YXNzZXJ0SlNPTn0gZnJvbSAnLi4vdGVzdC9Bc3NlcnRpb25zJztcbmltcG9ydCB7VGV4dEhpZ2hsaWdodHN9IGZyb20gJy4uL21ldGFkYXRhL1RleHRIaWdobGlnaHRzJztcblxuZGVzY3JpYmUoJ0RvY0Fubm90YXRpb25JbmRleGVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICBpdChcIkJhc2ljIHNvcnRpbmdcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc3QgYTA6IERvY0Fubm90YXRpb24gPSBjcmVhdGVBbm5vdGF0aW9uKCcwMDAxJywgMSwgMCwgMCApO1xuICAgICAgICBjb25zdCBhMTogRG9jQW5ub3RhdGlvbiA9IGNyZWF0ZUFubm90YXRpb24oJzAwMDInLCAxLCAwLCAwICk7XG4gICAgICAgIGNvbnN0IGEyOiBEb2NBbm5vdGF0aW9uID0gY3JlYXRlQW5ub3RhdGlvbignMDAwMycsIDEsIDAsIDAgKTtcblxuICAgICAgICBjb25zdCBkb2NBbm5vdGF0aW9uTWFwID0gY3JlYXRlRG9jQW5ub3RhdGlvbk1hcChhMCwgYTEpO1xuXG4gICAgICAgIGNvbnN0IGRvY0Fubm90YXRpb25JbmRleCA9IG5ldyBEb2NBbm5vdGF0aW9uSW5kZXgoZG9jQW5ub3RhdGlvbk1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QudmFsdWVzKGRvY0Fubm90YXRpb25NYXApKTtcblxuICAgICAgICBjb25zdCByZWJ1aWx0RG9jQW5ub3RhdGlvbkluZGV4ID0gRG9jQW5ub3RhdGlvbkluZGV4ZXMucmVidWlsZChkb2NBbm5vdGF0aW9uSW5kZXgsIGEyKTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZDogYW55ID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFwiaWRcIjogXCIwMDAxXCIsXG4gICAgICAgICAgICAgICAgXCJhbm5vdGF0aW9uVHlwZVwiOiBcIlRFWFRfSElHSExJR0hUXCIsXG4gICAgICAgICAgICAgICAgXCJwYWdlTnVtXCI6IDEsXG4gICAgICAgICAgICAgICAgXCJwb3NpdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwieFwiOiAwLFxuICAgICAgICAgICAgICAgICAgICBcInlcIjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVkXCI6IFwiMjAwOS0wNi0xNVQxMzo0NTozMFwiLFxuICAgICAgICAgICAgICAgIFwicGFnZU1ldGFcIjogbnVsbCxcbiAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtdLFxuICAgICAgICAgICAgICAgIFwiY29tbWVudHNcIjogW11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgXCJpZFwiOiBcIjAwMDJcIixcbiAgICAgICAgICAgICAgICBcImFubm90YXRpb25UeXBlXCI6IFwiVEVYVF9ISUdITElHSFRcIixcbiAgICAgICAgICAgICAgICBcInBhZ2VOdW1cIjogMSxcbiAgICAgICAgICAgICAgICBcInBvc2l0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJ4XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwieVwiOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImNyZWF0ZWRcIjogXCIyMDA5LTA2LTE1VDEzOjQ1OjMwXCIsXG4gICAgICAgICAgICAgICAgXCJwYWdlTWV0YVwiOiBudWxsLFxuICAgICAgICAgICAgICAgIFwiY2hpbGRyZW5cIjogW10sXG4gICAgICAgICAgICAgICAgXCJjb21tZW50c1wiOiBbXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcImlkXCI6IFwiMDAwM1wiLFxuICAgICAgICAgICAgICAgIFwiYW5ub3RhdGlvblR5cGVcIjogXCJURVhUX0hJR0hMSUdIVFwiLFxuICAgICAgICAgICAgICAgIFwicGFnZU51bVwiOiAxLFxuICAgICAgICAgICAgICAgIFwicG9zaXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICBcInhcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgXCJ5XCI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlZFwiOiBcIjIwMDktMDYtMTVUMTM6NDU6MzBcIixcbiAgICAgICAgICAgICAgICBcInBhZ2VNZXRhXCI6IG51bGwsXG4gICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXSxcbiAgICAgICAgICAgICAgICBcImNvbW1lbnRzXCI6IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gQXJyYXlzLmZpcnN0KHJlYnVpbHREb2NBbm5vdGF0aW9uSW5kZXguc29ydGVkRG9jQW5ub3RhdGlvbikhO1xuICAgICAgICBhc3NlcnRKU09OKHJlc3VsdCwgZXhwZWN0ZWQpO1xuXG4gICAgfSk7XG5cbiAgICBpdChcImNvbXBsZXggc29ydGluZ1wiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBjb25zdCBhMDogRG9jQW5ub3RhdGlvbiA9IGNyZWF0ZUFubm90YXRpb24oJzAwMDEnLCAzLCAwLCAxMDAgKTtcbiAgICAgICAgY29uc3QgYTE6IERvY0Fubm90YXRpb24gPSBjcmVhdGVBbm5vdGF0aW9uKCcwMDAyJywgMiwgMTAwLCAwICk7XG4gICAgICAgIGNvbnN0IGEyOiBEb2NBbm5vdGF0aW9uID0gY3JlYXRlQW5ub3RhdGlvbignMDAwMycsIDEsIDI1LCA1MCk7XG5cbiAgICAgICAgY29uc3QgZG9jQW5ub3RhdGlvbk1hcCA9IGNyZWF0ZURvY0Fubm90YXRpb25NYXAoYTAsIGExKTtcblxuICAgICAgICBjb25zdCBkb2NBbm5vdGF0aW9uSW5kZXggPSBuZXcgRG9jQW5ub3RhdGlvbkluZGV4KGRvY0Fubm90YXRpb25NYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhkb2NBbm5vdGF0aW9uTWFwKSk7XG5cbiAgICAgICAgY29uc3QgcmVidWlsdERvY0Fubm90YXRpb25JbmRleCA9IERvY0Fubm90YXRpb25JbmRleGVzLnJlYnVpbGQoZG9jQW5ub3RhdGlvbkluZGV4LCBhMik7XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQ6IGFueSA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcImlkXCI6IFwiMDAwM1wiLFxuICAgICAgICAgICAgICAgIFwiYW5ub3RhdGlvblR5cGVcIjogXCJURVhUX0hJR0hMSUdIVFwiLFxuICAgICAgICAgICAgICAgIFwicGFnZU51bVwiOiAxLFxuICAgICAgICAgICAgICAgIFwicG9zaXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICBcInhcIjogMjUsXG4gICAgICAgICAgICAgICAgICAgIFwieVwiOiA1MFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVkXCI6IFwiMjAwOS0wNi0xNVQxMzo0NTozMFwiLFxuICAgICAgICAgICAgICAgIFwicGFnZU1ldGFcIjogbnVsbCxcbiAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtdLFxuICAgICAgICAgICAgICAgIFwiY29tbWVudHNcIjogW11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgXCJpZFwiOiBcIjAwMDJcIixcbiAgICAgICAgICAgICAgICBcImFubm90YXRpb25UeXBlXCI6IFwiVEVYVF9ISUdITElHSFRcIixcbiAgICAgICAgICAgICAgICBcInBhZ2VOdW1cIjogMixcbiAgICAgICAgICAgICAgICBcInBvc2l0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJ4XCI6IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgXCJ5XCI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlZFwiOiBcIjIwMDktMDYtMTVUMTM6NDU6MzBcIixcbiAgICAgICAgICAgICAgICBcInBhZ2VNZXRhXCI6IG51bGwsXG4gICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXSxcbiAgICAgICAgICAgICAgICBcImNvbW1lbnRzXCI6IFtdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFwiaWRcIjogXCIwMDAxXCIsXG4gICAgICAgICAgICAgICAgXCJhbm5vdGF0aW9uVHlwZVwiOiBcIlRFWFRfSElHSExJR0hUXCIsXG4gICAgICAgICAgICAgICAgXCJwYWdlTnVtXCI6IDMsXG4gICAgICAgICAgICAgICAgXCJwb3NpdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwieFwiOiAwLFxuICAgICAgICAgICAgICAgICAgICBcInlcIjogMTAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImNyZWF0ZWRcIjogXCIyMDA5LTA2LTE1VDEzOjQ1OjMwXCIsXG4gICAgICAgICAgICAgICAgXCJwYWdlTWV0YVwiOiBudWxsLFxuICAgICAgICAgICAgICAgIFwiY2hpbGRyZW5cIjogW10sXG4gICAgICAgICAgICAgICAgXCJjb21tZW50c1wiOiBbXVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuXG4gICAgICAgIGFzc2VydEpTT04ocmVidWlsdERvY0Fubm90YXRpb25JbmRleC5zb3J0ZWREb2NBbm5vdGF0aW9uLCBleHBlY3RlZCk7XG5cbiAgICB9KTtcblxuXG59KTtcblxuZnVuY3Rpb24gY3JlYXRlQW5ub3RhdGlvbihpZDogc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlTnVtOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHg6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgeTogbnVtYmVyKTogRG9jQW5ub3RhdGlvbiB7XG5cbiAgICBjb25zdCB0ZXh0SGlnaGxpZ2h0ID0gVGV4dEhpZ2hsaWdodHMuY3JlYXRlTW9ja1RleHRIaWdobGlnaHQoKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGlkLFxuICAgICAgICBhbm5vdGF0aW9uVHlwZTogQW5ub3RhdGlvblR5cGUuVEVYVF9ISUdITElHSFQsXG4gICAgICAgIHBhZ2VOdW0sXG4gICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICB4LFxuICAgICAgICAgICAgeVxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVkOiAnMjAwOS0wNi0xNVQxMzo0NTozMCcsXG4gICAgICAgIHBhZ2VNZXRhOiBudWxsISxcbiAgICAgICAgY2hpbGRyZW46IFtdLFxuICAgICAgICBjb21tZW50czogW10sXG4gICAgICAgIG9yaWdpbmFsOiB0ZXh0SGlnaGxpZ2h0XG4gICAgfTtcblxufVxuXG5mdW5jdGlvbiBjcmVhdGVEb2NBbm5vdGF0aW9uTWFwKC4uLmRvY0Fubm90YXRpb25zOiBEb2NBbm5vdGF0aW9uW10pOiBEb2NBbm5vdGF0aW9uTWFwIHtcblxuICAgIGNvbnN0IHJlc3VsdDogRG9jQW5ub3RhdGlvbk1hcCA9IHt9O1xuXG4gICAgZG9jQW5ub3RhdGlvbnMgPSBBcnJheXMuc2h1ZmZsZSguLi5kb2NBbm5vdGF0aW9ucyk7XG5cbiAgICBmb3IgKGNvbnN0IGRvY0Fubm90YXRpb24gb2YgZG9jQW5ub3RhdGlvbnMpIHtcbiAgICAgICAgcmVzdWx0W2RvY0Fubm90YXRpb24uaWRdID0gZG9jQW5ub3RhdGlvbjtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuXG59XG4iXX0=