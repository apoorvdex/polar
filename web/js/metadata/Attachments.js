"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Hashcodes_1 = require("../Hashcodes");
const Attachment_1 = require("./Attachment");
const ISODateTimeStrings_1 = require("./ISODateTimeStrings");
let sequence = 0;
class Attachments {
    static createID(created) {
        const id = Hashcodes_1.Hashcodes.create(JSON.stringify({ created, sequence: sequence++ }));
        return id.substring(0, 10);
    }
    static create(type, data) {
        const created = ISODateTimeStrings_1.ISODateTimeStrings.create();
        const id = this.createID(created);
        return new Attachment_1.Attachment({
            id,
            created,
            type,
            data
        });
    }
}
exports.Attachments = Attachments;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXR0YWNobWVudHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJBdHRhY2htZW50cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUtBLDRDQUF1QztBQUN2Qyw2Q0FBd0M7QUFDeEMsNkRBQTJFO0FBRzNFLElBQUksUUFBUSxHQUFHLENBQUMsQ0FBQztBQUVqQixNQUFhLFdBQVc7SUFFYixNQUFNLENBQUMsUUFBUSxDQUFDLE9BQTBCO1FBRTdDLE1BQU0sRUFBRSxHQUFHLHFCQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxFQUFDLENBQUMsQ0FBQyxDQUFDO1FBRzdFLE9BQU8sRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFFL0IsQ0FBQztJQUVNLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBWSxFQUFFLElBQVk7UUFFM0MsTUFBTSxPQUFPLEdBQUcsdUNBQWtCLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDNUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUVsQyxPQUFPLElBQUksdUJBQVUsQ0FBQztZQUNsQixFQUFFO1lBQ0YsT0FBTztZQUNQLElBQUk7WUFDSixJQUFJO1NBQ1AsQ0FBQyxDQUFDO0lBRVAsQ0FBQztDQUVKO0FBekJELGtDQXlCQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlIGEgbmV3IHBhZ2VtYXJrIHdpdGggdGhlIGNyZWF0ZWQgdGltZSwgYW5kIG90aGVyIG1hbmRhdG9yeSBmaWVsZHNcbiAqIGFkZGVkLlxuICpcbiAqL1xuaW1wb3J0IHtIYXNoY29kZXN9IGZyb20gJy4uL0hhc2hjb2Rlcyc7XG5pbXBvcnQge0F0dGFjaG1lbnR9IGZyb20gJy4vQXR0YWNobWVudCc7XG5pbXBvcnQge0lTT0RhdGVUaW1lU3RyaW5nLCBJU09EYXRlVGltZVN0cmluZ3N9IGZyb20gJy4vSVNPRGF0ZVRpbWVTdHJpbmdzJztcblxuLy8gdXNlZCB0byBhdm9pZCBjb2xsaXNpb24gaWYgd2UgY3JlYXRlIG11bHRpcGxlIHRvbyBmYXN0LlxubGV0IHNlcXVlbmNlID0gMDtcblxuZXhwb3J0IGNsYXNzIEF0dGFjaG1lbnRzIHtcblxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlSUQoY3JlYXRlZDogSVNPRGF0ZVRpbWVTdHJpbmcpIHtcblxuICAgICAgICBjb25zdCBpZCA9IEhhc2hjb2Rlcy5jcmVhdGUoSlNPTi5zdHJpbmdpZnkoe2NyZWF0ZWQsIHNlcXVlbmNlOiBzZXF1ZW5jZSsrfSkpO1xuXG4gICAgICAgIC8vIHRydW5jYXRlLiAgV2UgZG9uJ3QgbmVlZCB0aGF0IG11Y2ggcHJlY2lzaW9uIGFnYWluc3QgY29sbGlzaW9uLlxuICAgICAgICByZXR1cm4gaWQuc3Vic3RyaW5nKDAsIDEwKTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlKHR5cGU6IHN0cmluZywgZGF0YTogc3RyaW5nKTogQXR0YWNobWVudCB7XG5cbiAgICAgICAgY29uc3QgY3JlYXRlZCA9IElTT0RhdGVUaW1lU3RyaW5ncy5jcmVhdGUoKTtcbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLmNyZWF0ZUlEKGNyZWF0ZWQpO1xuXG4gICAgICAgIHJldHVybiBuZXcgQXR0YWNobWVudCh7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIGNyZWF0ZWQsXG4gICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgZGF0YVxuICAgICAgICB9KTtcblxuICAgIH1cblxufVxuXG4iXX0=