"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Preconditions_1 = require("../Preconditions");
const Event_1 = require("./Event");
const Logger_1 = require("../logger/Logger");
const log = Logger_1.Logger.create();
class Reactor {
    constructor() {
        this.events = {};
    }
    registerEvent(eventName) {
        Preconditions_1.Preconditions.assertNotNull(eventName, "eventName");
        if (Preconditions_1.isPresent(this.events[eventName])) {
            return this;
        }
        const event = new Event_1.Event(eventName);
        this.events[eventName] = event;
        return this;
    }
    hasRegisteredEvent(eventName) {
        return Preconditions_1.isPresent(this.events[eventName]);
    }
    eventNames() {
        return Object.keys(this.events);
    }
    clearEvent(eventName) {
        const event = new Event_1.Event(eventName);
        this.events[eventName] = event;
        return this;
    }
    size(eventName) {
        if (this.events[eventName]) {
            return this.events[eventName].size();
        }
        return 0;
    }
    dispatchEvent(eventName, value) {
        Preconditions_1.Preconditions.assertNotNull(eventName, "eventName");
        const event = this.events[eventName];
        if (!event) {
            throw new Error("No events for event name: " + eventName);
        }
        event.getListeners().forEach((listener) => {
            try {
                listener(value);
            }
            catch (e) {
                log.error("listener generated unhandled exception: ", e);
            }
        });
        return this;
    }
    addEventListener(eventName, eventListener) {
        Preconditions_1.Preconditions.assertNotNull(eventName, "eventName");
        if (typeof eventListener !== "function") {
            throw new Error("listener is not a function: " + typeof eventListener);
        }
        if (this.events[eventName] === undefined) {
            throw new Error("No registered event for event name: " + eventName);
        }
        this.events[eventName].registerListener(eventListener);
        const release = () => {
            this.removeEventListener(eventName, eventListener);
        };
        return { eventListener, release };
    }
    removeEventListener(eventName, listener) {
        if (this.events[eventName]) {
            return this.events[eventName].removeListener(listener);
        }
        return false;
    }
    once(eventName) {
        return new Promise((resolve => {
            const listener = (event) => {
                resolve(event);
                this.removeEventListener(eventName, listener);
            };
            this.addEventListener(eventName, listener);
        }));
    }
    getEventListeners(eventName) {
        Preconditions_1.Preconditions.assertNotNull(eventName, "eventName");
        return this.events[eventName].getListeners();
    }
    hasEventListeners(eventName) {
        return this.hasRegisteredEvent(eventName) && this.events[eventName].hasListeners();
    }
}
exports.Reactor = Reactor;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVhY3Rvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlJlYWN0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxvREFBMEQ7QUFDMUQsbUNBQThCO0FBRTlCLDZDQUF3QztBQUd4QyxNQUFNLEdBQUcsR0FBRyxlQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7QUFFNUIsTUFBYSxPQUFPO0lBQXBCO1FBRXFCLFdBQU0sR0FBK0IsRUFBRSxDQUFDO0lBd0k3RCxDQUFDO0lBdElVLGFBQWEsQ0FBQyxTQUFpQjtRQUVsQyw2QkFBYSxDQUFDLGFBQWEsQ0FBQyxTQUFTLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFFcEQsSUFBSSx5QkFBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRTtZQUduQyxPQUFPLElBQUksQ0FBQztTQUNmO1FBRUQsTUFBTSxLQUFLLEdBQUcsSUFBSSxhQUFLLENBQUksU0FBUyxDQUFDLENBQUM7UUFDdEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUM7UUFFL0IsT0FBTyxJQUFJLENBQUM7SUFFaEIsQ0FBQztJQUVNLGtCQUFrQixDQUFDLFNBQWlCO1FBQ3ZDLE9BQU8seUJBQVMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVNLFVBQVU7UUFDYixPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFTSxVQUFVLENBQUMsU0FBaUI7UUFFL0IsTUFBTSxLQUFLLEdBQUcsSUFBSSxhQUFLLENBQUksU0FBUyxDQUFDLENBQUM7UUFDdEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUM7UUFDL0IsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUVNLElBQUksQ0FBQyxTQUFpQjtRQUV6QixJQUFJLElB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UyxDQUFDLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUN2RixDQUFDO0NBRUo7QUExSUQsMEJBMElDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc1ByZXNlbnQsIFByZWNvbmRpdGlvbnN9IGZyb20gJy4uL1ByZWNvbmRpdGlvbnMnO1xuaW1wb3J0IHtFdmVudH0gZnJvbSAnLi9FdmVudCc7XG5pbXBvcnQge0V2ZW50TGlzdGVuZXIsIFJlZ2lzdGVyZWRFdmVudExpc3RlbmVyfSBmcm9tICcuL0V2ZW50TGlzdGVuZXInO1xuaW1wb3J0IHtMb2dnZXJ9IGZyb20gJy4uL2xvZ2dlci9Mb2dnZXInO1xuaW1wb3J0IHtJU2ltcGxlUmVhY3Rvcn0gZnJvbSAnLi9TaW1wbGVSZWFjdG9yJztcblxuY29uc3QgbG9nID0gTG9nZ2VyLmNyZWF0ZSgpO1xuXG5leHBvcnQgY2xhc3MgUmVhY3RvcjxWPiBpbXBsZW1lbnRzIElSZWFjdG9yPFY+IHtcblxuICAgIHByaXZhdGUgcmVhZG9ubHkgZXZlbnRzOiB7W25hbWU6IHN0cmluZ106IEV2ZW50PFY+fSA9IHt9O1xuXG4gICAgcHVibGljIHJlZ2lzdGVyRXZlbnQoZXZlbnROYW1lOiBzdHJpbmcpOiB0aGlzIHtcblxuICAgICAgICBQcmVjb25kaXRpb25zLmFzc2VydE5vdE51bGwoZXZlbnROYW1lLCBcImV2ZW50TmFtZVwiKTtcblxuICAgICAgICBpZiAoaXNQcmVzZW50KHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0pKSB7XG4gICAgICAgICAgICAvLyBhbHJlYWR5IHJlZ2lzdGVyZWQgc28gZG9uJ3QgZG91YmxlIHJlZ2lzdGVyIHdoaWNoIHdvdWxkIGtpbGxcbiAgICAgICAgICAgIC8vIHRoZSBleGlzdGluZyBsaXN0ZW5lcnMuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50PFY+KGV2ZW50TmFtZSk7XG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPSBldmVudDtcblxuICAgICAgICByZXR1cm4gdGhpcztcblxuICAgIH1cblxuICAgIHB1YmxpYyBoYXNSZWdpc3RlcmVkRXZlbnQoZXZlbnROYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGlzUHJlc2VudCh0aGlzLmV2ZW50c1tldmVudE5hbWVdKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZXZlbnROYW1lcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLmV2ZW50cyk7XG4gICAgfVxuXG4gICAgcHVibGljIGNsZWFyRXZlbnQoZXZlbnROYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgLy8gcmVwbGFjZSBpdCB3aXRoIGEgbmV3IGV2ZW50IHRvIGNsZWFyIHRoZSBwcmV2aW91cyBsaXN0ZW5lcnMuXG4gICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50PFY+KGV2ZW50TmFtZSk7XG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPSBldmVudDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgcHVibGljIHNpemUoZXZlbnROYW1lOiBzdHJpbmcpIHtcblxuICAgICAgICBpZiAodGhpcy5ldmVudHNbZXZlbnROYW1lXSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0uc2l6ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZlbnROYW1lIFRoZSBuYW1lIG9mIHRoZSBldmVudCB0byBkaXNwYXRjaC5cbiAgICAgKiBAcGFyYW0gdmFsdWUgVGhlIGV2ZW50IHZhbHVlIHRvIGRpc3BhdGNoIHRvIGxpc3RlbmVycyBvZiB0aGF0IGV2ZW50IG5hbWUuXG4gICAgICogQHJldHVybiB7UmVhY3Rvcn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZGlzcGF0Y2hFdmVudChldmVudE5hbWU6IHN0cmluZywgdmFsdWU6IFYpIHtcblxuICAgICAgICBQcmVjb25kaXRpb25zLmFzc2VydE5vdE51bGwoZXZlbnROYW1lLCBcImV2ZW50TmFtZVwiKTtcblxuICAgICAgICBjb25zdCBldmVudCA9IHRoaXMuZXZlbnRzW2V2ZW50TmFtZV07XG5cbiAgICAgICAgaWYgKCEgZXZlbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGV2ZW50cyBmb3IgZXZlbnQgbmFtZTogXCIgKyBldmVudE5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZXZlbnQuZ2V0TGlzdGVuZXJzKCkuZm9yRWFjaCgobGlzdGVuZXIpID0+IHtcblxuICAgICAgICAgICAgdHJ5IHtcblxuICAgICAgICAgICAgICAgIGxpc3RlbmVyKHZhbHVlKTtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGxvZy5lcnJvcihcImxpc3RlbmVyIGdlbmVyYXRlZCB1bmhhbmRsZWQgZXhjZXB0aW9uOiBcIiwgZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWU6IHN0cmluZywgZXZlbnRMaXN0ZW5lcjogRXZlbnRMaXN0ZW5lcjxWPik6IFJlZ2lzdGVyZWRFdmVudExpc3RlbmVyPFY+IHtcblxuICAgICAgICBQcmVjb25kaXRpb25zLmFzc2VydE5vdE51bGwoZXZlbnROYW1lLCBcImV2ZW50TmFtZVwiKTtcblxuICAgICAgICBpZiAodHlwZW9mIGV2ZW50TGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibGlzdGVuZXIgaXMgbm90IGEgZnVuY3Rpb246IFwiICsgdHlwZW9mIGV2ZW50TGlzdGVuZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gcmVnaXN0ZXJlZCBldmVudCBmb3IgZXZlbnQgbmFtZTogXCIgKyBldmVudE5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5ldmVudHNbZXZlbnROYW1lXS5yZWdpc3Rlckxpc3RlbmVyKGV2ZW50TGlzdGVuZXIpO1xuXG4gICAgICAgIGNvbnN0IHJlbGVhc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBldmVudExpc3RlbmVyKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge2V2ZW50TGlzdGVuZXIsIHJlbGVhc2V9O1xuXG4gICAgfVxuXG4gICAgcHVibGljIHJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lOiBzdHJpbmcsIGxpc3RlbmVyOiBFdmVudExpc3RlbmVyPFY+KTogYm9vbGVhbiB7XG5cbiAgICAgICAgaWYgKHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV2ZW50c1tldmVudE5hbWVdLnJlbW92ZUxpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBvbmNlKGV2ZW50TmFtZTogc3RyaW5nKTogUHJvbWlzZTxWPiB7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPFY+KChyZXNvbHZlID0+IHtcblxuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXIgPSAoZXZlbnQ6IFYpID0+IHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGV2ZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcik7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcik7XG5cbiAgICAgICAgfSkpO1xuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZlbnROYW1lIHtTdHJpbmd9IFRoZSBuYW1lIG9mIHRoZSBldmVudCBmb3IgdGhlIGxpc3RlbmVycy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0RXZlbnRMaXN0ZW5lcnMoZXZlbnROYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgUHJlY29uZGl0aW9ucy5hc3NlcnROb3ROdWxsKGV2ZW50TmFtZSwgXCJldmVudE5hbWVcIik7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0uZ2V0TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGhhc0V2ZW50TGlzdGVuZXJzKGV2ZW50TmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc1JlZ2lzdGVyZWRFdmVudChldmVudE5hbWUpICYmIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0uaGFzTGlzdGVuZXJzKCk7XG4gICAgfVxuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJlYWN0b3I8Vj4ge1xuICAgIG9uY2UoZXZlbnROYW1lOiBzdHJpbmcpOiBQcm9taXNlPFY+O1xuICAgIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lOiBzdHJpbmcsIGxpc3RlbmVyOiBFdmVudExpc3RlbmVyPFY+KTogUmVnaXN0ZXJlZEV2ZW50TGlzdGVuZXI8Vj47XG4gICAgZGlzcGF0Y2hFdmVudChldmVudE5hbWU6IHN0cmluZywgdmFsdWU6IFYpOiB2b2lkO1xuICAgIGhhc1JlZ2lzdGVyZWRFdmVudChldmVudE5hbWU6IHN0cmluZyk6IGJvb2xlYW47XG4gICAgaGFzRXZlbnRMaXN0ZW5lcnMoZXZlbnROYW1lOiBzdHJpbmcpOiBib29sZWFuO1xuICAgIHJlZ2lzdGVyRXZlbnQoZXZlbnROYW1lOiBzdHJpbmcpOiBJUmVhY3RvcjxWPjtcbiAgICBzaXplKGV2ZW50TmFtZTogc3RyaW5nKTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElNdXRhYmxlUmVhY3RvcjxWPiBleHRlbmRzIElSZWFjdG9yPFY+IHtcbiAgICBjbGVhckV2ZW50KGV2ZW50TmFtZTogc3RyaW5nKTogdm9pZDtcbiAgICByZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZTogc3RyaW5nLCBsaXN0ZW5lcjogRXZlbnRMaXN0ZW5lcjxWPik6IGJvb2xlYW47XG4gICAgZ2V0RXZlbnRMaXN0ZW5lcnMoZXZlbnROYW1lOiBzdHJpbmcpOiBBcnJheTxFdmVudExpc3RlbmVyPFY+PjtcbiAgICBzaXplKGV2ZW50TmFtZTogc3RyaW5nKTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElOYW1lZEV2ZW50RGlzcGF0Y2hlcjxWPiBleHRlbmRzIElSZWFjdG9yPFY+IHtcblxufVxuIl19