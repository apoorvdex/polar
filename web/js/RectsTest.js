"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const chai_1 = require("chai");
const Rects_1 = require("./Rects");
const Assertions_1 = require("./test/Assertions");
const Rect_1 = require("./Rect");
const RectArt_1 = require("./util/RectArt");
const MockRects_1 = require("./MockRects");
describe('Rects', function () {
    describe('perc', function () {
        it("basic perc", function () {
            let a = Rects_1.Rects.createFromBasicRect({
                top: 0,
                left: 0,
                width: 50,
                height: 50
            });
            let b = Rects_1.Rects.createFromBasicRect({
                top: 0,
                left: 0,
                width: 100,
                height: 100
            });
            let actual = Rects_1.Rects.perc(a, b);
            let expected = {
                "left": 0,
                "top": 0,
                "right": 50,
                "bottom": 50,
                "width": 50,
                "height": 50
            };
            Assertions_1.assertJSON(actual, expected);
        });
    });
    describe('scale', function () {
        it("basic scale", function () {
            let rect = new Rect_1.Rect({
                top: 100,
                left: 100,
                bottom: 200,
                right: 200,
                width: 100,
                height: 100,
            });
            let actual = Rects_1.Rects.scale(rect, 2.0);
            let expected = {
                "left": 200,
                "top": 200,
                "right": 400,
                "bottom": 400,
                "width": 200,
                "height": 200
            };
            Assertions_1.assertJSON(actual, expected);
        });
    });
    describe('intersect + overlap', () => {
        test("not_intersected", false, false);
        test("basic_test", true, true);
        test("intersected_right", true, true);
        test("intersected_left", true, true);
        test("intersected_top", true, true);
        test("intersected_bottom", true, true);
        test("intersected_bottom_left", true, true);
        function test(name, expectedIntersect, expectedOverlap) {
            it(name, () => {
                let rects = MockRects_1.MOCK_RECTS[name];
                console.log("\n" + RectArt_1.RectArt.formatRects([rects.rect0, rects.rect1]).toString());
                chai_1.assert.equal(Rects_1.Rects.intersect(rects.rect0, rects.rect1), expectedIntersect);
                chai_1.assert.equal(Rects_1.Rects.overlap(rects.rect0, rects.rect1), expectedOverlap);
            });
        }
    });
    describe('intersectedPositions', function () {
        it("not intersected", function () {
            let rect0 = Rects_1.Rects.createFromBasicRect({
                "left": 100,
                "top": 100,
                "width": 100,
                "height": 100
            });
            let rect1 = Rects_1.Rects.createFromBasicRect({
                "left": 300,
                "top": 300,
                "width": 100,
                "height": 100
            });
            Assertions_1.assertJSON(Rects_1.Rects.intersectedPositions(rect0, rect1), []);
        });
        it("intersected right", function () {
            let rect0 = Rects_1.Rects.createFromBasicRect({
                "left": 100,
                "top": 100,
                "width": 100,
                "height": 100
            });
            let rect1 = Rects_1.Rects.createFromBasicRect({
                "left": 150,
                "top": 100,
                "width": 100,
                "height": 100
            });
            Assertions_1.assertJSON(Rects_1.Rects.intersectedPositions(rect0, rect1), ["right", "top", "bottom"]);
        });
        it("intersected left", function () {
            let rect0 = Rects_1.Rects.createFromBasicRect({
                "left": 100,
                "top": 100,
                "width": 100,
                "height": 100
            });
            let rect1 = Rects_1.Rects.createFromBasicRect({
                "left": 50,
                "top": 100,
                "width": 100,
                "height": 100
            });
            Assertions_1.assertJSON(Rects_1.Rects.intersectedPositions(rect0, rect1), ["left", "top", "bottom"]);
        });
        it("intersected top", function () {
            let rect0 = Rects_1.Rects.createFromBasicRect({
                "left": 100,
                "top": 100,
                "width": 100,
                "height": 100
            });
            let rect1 = Rects_1.Rects.createFromBasicRect({
                "left": 100,
                "top": 50,
                "width": 100,
                "height": 100
            });
            Assertions_1.assertJSON(Rects_1.Rects.intersectedPositions(rect0, rect1), ["left", "right", "top"]);
        });
        it("intersected bottom", function () {
            let rect0 = Rects_1.Rects.createFromBasicRect({
                "left": 100,
                "top": 100,
                "width": 100,
                "height": 100
            });
            let rect1 = Rects_1.Rects.createFromBasicRect({
                "left": 100,
                "top": 150,
                "width": 100,
                "height": 100
            });
            Assertions_1.assertJSON(Rects_1.Rects.intersectedPositions(rect0, rect1), ["left", "right", "bottom"]);
        });
        it("intersected bottom left", function () {
            let rect0 = Rects_1.Rects.createFromBasicRect({
                "left": 100,
                "top": 100,
                "width": 100,
                "height": 100
            });
            let rect1 = Rects_1.Rects.createFromBasicRect({
                "left": 50,
                "top": 150,
                "width": 100,
                "height": 100
            });
            Assertions_1.assertJSON(Rects_1.Rects.intersectedPositions(rect0, rect1), ["left", "bottom"]);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVjdHNUZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiUmVjdHNUZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsK0JBQTRCO0FBQzVCLG1DQUE4QjtBQUM5QixrREFBNkM7QUFDN0MsaUNBQTRCO0FBRTVCLDRDQUF1QztBQUN2QywyQ0FBdUM7QUFFdkMsUUFBUSxDQUFDLE9BQU8sRUFBRTtJQUVkLFFBQVEsQ0FBQyxNQUFNLEVBQUU7UUFFYixFQUFFLENBQUMsWUFBWSxFQUFFO1lBRWIsSUFBSSxDQUFDLEdBQUcsYUFBSyxDQUFDLG1CQUFtQixDQUFDO2dCQUM5QixHQUFHLEVBQUUsQ0FBQztnQkFDTixJQUFJLEVBQUUsQ0FBQztnQkFDUCxLQUFLLEVBQUUsRUFBRTtnQkFDVCxNQUFNLEVBQUUsRUFBRTthQUNiLENBQUMsQ0FBQztZQUVILElBQUksQ0FBQyxHQUFHLGFBQUssQ0FBQyxtQkFBbUIsQ0FBQztnQkFDOUIsR0FBRyxFQUFFLENBQUM7Z0JBQ04sSUFBSSxFQUFFLENBQUM7Z0JBQ1AsS0FBSyxFQUFFLEdBQUc7Z0JBQ1YsTUFBTSxFQUFFLEdBQUc7YUFDZCxDQUFDLENBQUM7WUFFSCxJQUFJLE1BQU0sR0FBRyxhQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUU5QixJQUFJLFFBQVEsR0FBRztnQkFDWCxNQUFNLEVBQUUsQ0FBQztnQkFDVCxLQUFLLEVBQUUsQ0FBQztnQkFDUixPQUFPLEVBQUUsRUFBRTtnQkFDWCxRQUFRLEVBQUUsRUFBRTtnQkFDWixPQUFPLEVBQUUsRUFBRTtnQkFDWCxRQUFRLEVBQUUsRUFBRTthQUNmLENBQUM7WUFFRix1QkFBVSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztRQUVqQyxDQUFDLENBQUMsQ0FBQztJQUdQLENBQUMsQ0FBQyxDQUFDO0lBR0gsUUFBUSxDQUFDLE9BQU8sRUFBRTtRQUVkLEVBQUUsQ0FBQyxhQUFhLEVBQUU7WUFFZCxJ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LENBQUM7UUFFdEYsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMseUJBQXlCLEVBQUU7WUFFMUIsSUFBSSxLQUFLLEdBQUcsYUFBSyxDQUFDLG1CQUFtQixDQUFDO2dCQUNsQyxNQUFNLEVBQUUsR0FBRztnQkFDWCxLQUFLLEVBQUUsR0FBRztnQkFDVixPQUFPLEVBQUUsR0FBRztnQkFDWixRQUFRLEVBQUUsR0FBRzthQUNoQixDQUFDLENBQUM7WUFFSCxJQUFJLEtBQUssR0FBRyxhQUFLLENBQUMsbUJBQW1CLENBQUM7Z0JBQ2xDLE1BQU0sRUFBRSxFQUFFO2dCQUNWLEtBQUssRUFBRSxHQUFHO2dCQUNWLE9BQU8sRUFBRSxHQUFHO2dCQUNaLFFBQVEsRUFBRSxHQUFHO2FBQ2hCLENBQUMsQ0FBQztZQUVILHVCQUFVLENBQUMsYUFBSyxDQUFDLG9CQUFvQixDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBRTdFLENBQUMsQ0FBQyxDQUFDO0lBRVAsQ0FBQyxDQUFDLENBQUM7QUFFUCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7YXNzZXJ0fSBmcm9tICdjaGFpJztcbmltcG9ydCB7UmVjdHN9IGZyb20gJy4vUmVjdHMnO1xuaW1wb3J0IHthc3NlcnRKU09OfSBmcm9tICcuL3Rlc3QvQXNzZXJ0aW9ucyc7XG5pbXBvcnQge1JlY3R9IGZyb20gJy4vUmVjdCc7XG5pbXBvcnQge0lSZWN0fSBmcm9tICcuL3V0aWwvcmVjdHMvSVJlY3QnO1xuaW1wb3J0IHtSZWN0QXJ0fSBmcm9tICcuL3V0aWwvUmVjdEFydCc7XG5pbXBvcnQge01PQ0tfUkVDVFN9IGZyb20gJy4vTW9ja1JlY3RzJztcblxuZGVzY3JpYmUoJ1JlY3RzJywgZnVuY3Rpb24oKSB7XG5cbiAgICBkZXNjcmliZSgncGVyYycsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGl0KFwiYmFzaWMgcGVyY1wiLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGxldCBhID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7XG4gICAgICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDUwLFxuICAgICAgICAgICAgICAgIGhlaWdodDogNTBcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgYiA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe1xuICAgICAgICAgICAgICAgIHRvcDogMCxcbiAgICAgICAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDBcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgYWN0dWFsID0gUmVjdHMucGVyYyhhLCBiKTtcblxuICAgICAgICAgICAgbGV0IGV4cGVjdGVkID0ge1xuICAgICAgICAgICAgICAgIFwibGVmdFwiOiAwLFxuICAgICAgICAgICAgICAgIFwidG9wXCI6IDAsXG4gICAgICAgICAgICAgICAgXCJyaWdodFwiOiA1MCxcbiAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiA1MCxcbiAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDUwLFxuICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDUwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhc3NlcnRKU09OKGFjdHVhbCwgZXhwZWN0ZWQpO1xuXG4gICAgICAgIH0pO1xuXG5cbiAgICB9KTtcblxuXG4gICAgZGVzY3JpYmUoJ3NjYWxlJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgaXQoXCJiYXNpYyBzY2FsZVwiLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGxldCByZWN0ID0gbmV3IFJlY3Qoe1xuICAgICAgICAgICAgICAgIHRvcDogMTAwLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDEwMCxcbiAgICAgICAgICAgICAgICBib3R0b206IDIwMCxcbiAgICAgICAgICAgICAgICByaWdodDogMjAwLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbGV0IGFjdHVhbCA9IFJlY3RzLnNjYWxlKHJlY3QsIDIuMCk7XG5cbiAgICAgICAgICAgIGxldCBleHBlY3RlZCA9IHtcbiAgICAgICAgICAgICAgICBcImxlZnRcIjogMjAwLFxuICAgICAgICAgICAgICAgIFwidG9wXCI6IDIwMCxcbiAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDQwMCxcbiAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiA0MDAsXG4gICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAyMDAsXG4gICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMjAwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhc3NlcnRKU09OKGFjdHVhbCwgZXhwZWN0ZWQpO1xuXG4gICAgICAgIH0pO1xuXG5cbiAgICB9KTtcblxuXG4gICAgZGVzY3JpYmUoJ2ludGVyc2VjdCArIG92ZXJsYXAnLCAoKSA9PiB7XG5cbiAgICAgICAgdGVzdChcIm5vdF9pbnRlcnNlY3RlZFwiLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICB0ZXN0KFwiYmFzaWNfdGVzdFwiLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgdGVzdChcImludGVyc2VjdGVkX3JpZ2h0XCIsIHRydWUsIHRydWUpO1xuICAgICAgICB0ZXN0KFwiaW50ZXJzZWN0ZWRfbGVmdFwiLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgdGVzdChcImludGVyc2VjdGVkX3RvcFwiLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgdGVzdChcImludGVyc2VjdGVkX2JvdHRvbVwiLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgdGVzdChcImludGVyc2VjdGVkX2JvdHRvbV9sZWZ0XCIsIHRydWUsIHRydWUpO1xuXG4gICAgICAgIC8vdGVzdChcIm92ZXJsYXBfcmVjdDBfb3Zlcl9yZWN0MVwiLCBmYWxzZSwgdHJ1ZSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSBuYW1lIHtzdHJpbmd9IFRoZSBuYW1lIG9mIHRoZSB0ZXN0IGFuZCB0aGUgZGF0YSB0byBleHRyYWN0LlxuICAgICAgICAgKiBAcGFyYW0gZXhwZWN0ZWRJbnRlcnNlY3Qge2Jvb2xlYW59XG4gICAgICAgICAqIEBwYXJhbSBleHBlY3RlZE92ZXJsYXAge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiB0ZXN0KG5hbWU6IHN0cmluZywgZXhwZWN0ZWRJbnRlcnNlY3Q6IGJvb2xlYW4sIGV4cGVjdGVkT3ZlcmxhcDogYm9vbGVhbikge1xuXG4gICAgICAgICAgICBpdChuYW1lLCAoKSA9PiB7XG5cbiAgICAgICAgICAgICAgICBsZXQgcmVjdHMgPSBNT0NLX1JFQ1RTW25hbWVdO1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJcXG5cIiArIFJlY3RBcnQuZm9ybWF0UmVjdHMoW3JlY3RzLnJlY3QwLCByZWN0cy5yZWN0MV0pLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKFJlY3RzLmludGVyc2VjdChyZWN0cy5yZWN0MCwgcmVjdHMucmVjdDEpLCBleHBlY3RlZEludGVyc2VjdCk7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKFJlY3RzLm92ZXJsYXAocmVjdHMucmVjdDAsIHJlY3RzLnJlY3QxKSwgZXhwZWN0ZWRPdmVybGFwKTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG5cblxuICAgIGRlc2NyaWJlKCdpbnRlcnNlY3RlZFBvc2l0aW9ucycsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGl0KFwibm90IGludGVyc2VjdGVkXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbGV0IHJlY3QwID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7XG4gICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDEwMCxcbiAgICAgICAgICAgICAgICBcInRvcFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMTAwXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbGV0IHJlY3QxID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7XG4gICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDMwMCxcbiAgICAgICAgICAgICAgICBcInRvcFwiOiAzMDAsXG4gICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMTAwXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYXNzZXJ0SlNPTihSZWN0cy5pbnRlcnNlY3RlZFBvc2l0aW9ucyhyZWN0MCwgcmVjdDEpLCBbXSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJpbnRlcnNlY3RlZCByaWdodFwiLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGxldCByZWN0MCA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe1xuICAgICAgICAgICAgICAgIFwibGVmdFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJ0b3BcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwid2lkdGhcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDEwMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCByZWN0MSA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe1xuICAgICAgICAgICAgICAgIFwibGVmdFwiOiAxNTAsXG4gICAgICAgICAgICAgICAgXCJ0b3BcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwid2lkdGhcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDEwMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGFzc2VydEpTT04oUmVjdHMuaW50ZXJzZWN0ZWRQb3NpdGlvbnMocmVjdDAsIHJlY3QxKSwgW1wicmlnaHRcIiwgXCJ0b3BcIiwgXCJib3R0b21cIl0pO1xuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiaW50ZXJzZWN0ZWQgbGVmdFwiLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGxldCByZWN0MCA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe1xuICAgICAgICAgICAgICAgIFwibGVmdFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJ0b3BcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwid2lkdGhcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDEwMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCByZWN0MSA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe1xuICAgICAgICAgICAgICAgIFwibGVmdFwiOiA1MCxcbiAgICAgICAgICAgICAgICBcInRvcFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMTAwXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYXNzZXJ0SlNPTihSZWN0cy5pbnRlcnNlY3RlZFBvc2l0aW9ucyhyZWN0MCwgcmVjdDEpLCBbXCJsZWZ0XCIsIFwidG9wXCIsIFwiYm90dG9tXCJdKTtcblxuICAgICAgICB9KTtcblxuXG4gICAgICAgIGl0KFwiaW50ZXJzZWN0ZWQgdG9wXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbGV0IHJlY3QwID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7XG4gICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDEwMCxcbiAgICAgICAgICAgICAgICBcInRvcFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMTAwXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbGV0IHJlY3QxID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7XG4gICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDEwMCxcbiAgICAgICAgICAgICAgICBcInRvcFwiOiA1MCxcbiAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDEwMCxcbiAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxMDBcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBhc3NlcnRKU09OKFJlY3RzLmludGVyc2VjdGVkUG9zaXRpb25zKHJlY3QwLCByZWN0MSksIFtcImxlZnRcIiwgXCJyaWdodFwiLCBcInRvcFwiXSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJpbnRlcnNlY3RlZCBib3R0b21cIiwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBsZXQgcmVjdDAgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHtcbiAgICAgICAgICAgICAgICBcImxlZnRcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwidG9wXCI6IDEwMCxcbiAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDEwMCxcbiAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxMDBcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgcmVjdDEgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHtcbiAgICAgICAgICAgICAgICBcImxlZnRcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwidG9wXCI6IDE1MCxcbiAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDEwMCxcbiAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxMDBcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBhc3NlcnRKU09OKFJlY3RzLmludGVyc2VjdGVkUG9zaXRpb25zKHJlY3QwLCByZWN0MSksIFtcImxlZnRcIiwgXCJyaWdodFwiLCBcImJvdHRvbVwiXSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJpbnRlcnNlY3RlZCBib3R0b20gbGVmdFwiLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGxldCByZWN0MCA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe1xuICAgICAgICAgICAgICAgIFwibGVmdFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJ0b3BcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwid2lkdGhcIjogMTAwLFxuICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDEwMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCByZWN0MSA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe1xuICAgICAgICAgICAgICAgIFwibGVmdFwiOiA1MCxcbiAgICAgICAgICAgICAgICBcInRvcFwiOiAxNTAsXG4gICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMTAwXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYXNzZXJ0SlNPTihSZWN0cy5pbnRlcnNlY3RlZFBvc2l0aW9ucyhyZWN0MCwgcmVjdDEpLCBbXCJsZWZ0XCIsIFwiYm90dG9tXCJdKTtcblxuICAgICAgICB9KTtcblxuICAgIH0pO1xuXG59KTtcbiJdfQ==